var $n=Object.defineProperty;var Zn=(e,t,r)=>t in e?$n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var zt=(e,t,r)=>(Zn(e,typeof t!="symbol"?t+"":t,r),r),Dr=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var E=(e,t,r)=>(Dr(e,t,"read from private field"),r?r.call(e):t.get(e)),ot=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},gt=(e,t,r,i)=>(Dr(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);var F=(e,t,r)=>(Dr(e,t,"access private method"),r);import{S as Qn,i as ti,s as ei,a as Ue,k as Yt,q as gr,J as ri,h as Ut,c as Ee,l as Xt,m as se,r as xr,n as Vt,b as Fe,C as Ot,R as yn,D as Hr,T as ni,u as ii}from"../chunks/index.25ef2629.js";var ye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ai(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function si(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){if(this instanceof i){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(t,s);return new o}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var s=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:function(){return e[i]}})}),r}var ir={},wr={};function oi(e){var t=new St(e),r=t.readChunk();if(r.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+r.id+"'";for(var i=ci(r.data),s=[],o=0;!t.eof()&&o<i.numTracks;o++){var n=t.readChunk();if(n.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+n.id+"'";var l=ui(n.data);s.push(l)}return{header:i,tracks:s}}function ci(e){var t=new St(e),r=t.readUInt16(),i=t.readUInt16(),s={format:r,numTracks:i},o=t.readUInt16();return o&32768?(s.framesPerSecond=256-(o>>8),s.ticksPerFrame=o&255):s.ticksPerBeat=o,s}function ui(e){for(var t=new St(e),r=[];!t.eof();){var i=o();r.push(i)}return r;var s;function o(){var n={};n.deltaTime=t.readVarInt();var l=t.readUInt8();if((l&240)===240)if(l===255){n.meta=!0;var u=t.readUInt8(),f=t.readVarInt();switch(u){case 0:if(n.type="sequenceNumber",f!==2)throw"Expected length for sequenceNumber event is 2, got "+f;return n.number=t.readUInt16(),n;case 1:return n.type="text",n.text=t.readString(f),n;case 2:return n.type="copyrightNotice",n.text=t.readString(f),n;case 3:return n.type="trackName",n.text=t.readString(f),n;case 4:return n.type="instrumentName",n.text=t.readString(f),n;case 5:return n.type="lyrics",n.text=t.readString(f),n;case 6:return n.type="marker",n.text=t.readString(f),n;case 7:return n.type="cuePoint",n.text=t.readString(f),n;case 32:if(n.type="channelPrefix",f!=1)throw"Expected length for channelPrefix event is 1, got "+f;return n.channel=t.readUInt8(),n;case 33:if(n.type="portPrefix",f!=1)throw"Expected length for portPrefix event is 1, got "+f;return n.port=t.readUInt8(),n;case 47:if(n.type="endOfTrack",f!=0)throw"Expected length for endOfTrack event is 0, got "+f;return n;case 81:if(n.type="setTempo",f!=3)throw"Expected length for setTempo event is 3, got "+f;return n.microsecondsPerBeat=t.readUInt24(),n;case 84:if(n.type="smpteOffset",f!=5)throw"Expected length for smpteOffset event is 5, got "+f;var S=t.readUInt8(),k={0:24,32:25,64:29,96:30};return n.frameRate=k[S&96],n.hour=S&31,n.min=t.readUInt8(),n.sec=t.readUInt8(),n.frame=t.readUInt8(),n.subFrame=t.readUInt8(),n;case 88:if(n.type="timeSignature",f!=2&&f!=4)throw"Expected length for timeSignature event is 4 or 2, got "+f;return n.numerator=t.readUInt8(),n.denominator=1<<t.readUInt8(),f===4?(n.metronome=t.readUInt8(),n.thirtyseconds=t.readUInt8()):(n.metronome=36,n.thirtyseconds=8),n;case 89:if(n.type="keySignature",f!=2)throw"Expected length for keySignature event is 2, got "+f;return n.key=t.readInt8(),n.scale=t.readUInt8(),n;case 127:return n.type="sequencerSpecific",n.data=t.readBytes(f),n;default:return n.type="unknownMeta",n.data=t.readBytes(f),n.metatypeByte=u,n}}else if(l==240){n.type="sysEx";var f=t.readVarInt();return n.data=t.readBytes(f),n}else if(l==247){n.type="endSysEx";var f=t.readVarInt();return n.data=t.readBytes(f),n}else throw"Unrecognised MIDI event type byte: "+l;else{var m;if(l&128)m=t.readUInt8(),s=l;else{if(s===null)throw"Running status byte encountered before status byte";m=l,l=s,n.running=!0}var v=l>>4;switch(n.channel=l&15,v){case 8:return n.type="noteOff",n.noteNumber=m,n.velocity=t.readUInt8(),n;case 9:var O=t.readUInt8();return n.type=O===0?"noteOff":"noteOn",n.noteNumber=m,n.velocity=O,O===0&&(n.byte9=!0),n;case 10:return n.type="noteAftertouch",n.noteNumber=m,n.amount=t.readUInt8(),n;case 11:return n.type="controller",n.controllerType=m,n.value=t.readUInt8(),n;case 12:return n.type="programChange",n.programNumber=m,n;case 13:return n.type="channelAftertouch",n.amount=m,n;case 14:return n.type="pitchBend",n.value=m+(t.readUInt8()<<7)-8192,n;default:throw"Unrecognised MIDI event type: "+v}}}}function St(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}St.prototype.eof=function(){return this.pos>=this.bufferLen};St.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e};St.prototype.readInt8=function(){var e=this.readUInt8();return e&128?e-256:e};St.prototype.readUInt16=function(){var e=this.readUInt8(),t=this.readUInt8();return(e<<8)+t};St.prototype.readInt16=function(){var e=this.readUInt16();return e&32768?e-65536:e};St.prototype.readUInt24=function(){var e=this.readUInt8(),t=this.readUInt8(),r=this.readUInt8();return(e<<16)+(t<<8)+r};St.prototype.readInt24=function(){var e=this.readUInt24();return e&8388608?e-16777216:e};St.prototype.readUInt32=function(){var e=this.readUInt8(),t=this.readUInt8(),r=this.readUInt8(),i=this.readUInt8();return(e<<24)+(t<<16)+(r<<8)+i};St.prototype.readBytes=function(e){var t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t};St.prototype.readString=function(e){var t=this.readBytes(e);return String.fromCharCode.apply(null,t)};St.prototype.readVarInt=function(){for(var e=0;!this.eof();){var t=this.readUInt8();if(t&128)e+=t&127,e<<=7;else return e+t}return e};St.prototype.readChunk=function(){var e=this.readString(4),t=this.readUInt32(),r=this.readBytes(t);return{id:e,length:t,data:r}};var fi=oi;function li(e,t){if(typeof e!="object")throw"Invalid MIDI data";t=t||{};var r=e.header||{},i=e.tracks||[],s,o=i.length,n=new ht;for(hi(n,r,o),s=0;s<o;s++)di(n,i[s],t);return n.buffer}function hi(e,t,r){var i=t.format==null?1:t.format,s=128;t.timeDivision?s=t.timeDivision:t.ticksPerFrame&&t.framesPerSecond?s=-(t.framesPerSecond&255)<<8|t.ticksPerFrame&255:t.ticksPerBeat&&(s=t.ticksPerBeat&32767);var o=new ht;o.writeUInt16(i),o.writeUInt16(r),o.writeUInt16(s),e.writeChunk("MThd",o.buffer)}function di(e,t,r){var i=new ht,s,o=t.length,n=null;for(s=0;s<o;s++)(r.running===!1||!r.running&&!t[s].running)&&(n=null),n=pi(i,t[s],n,r.useByte9ForNoteOff);e.writeChunk("MTrk",i.buffer)}function pi(e,t,r,i){var s=t.type,o=t.deltaTime,n=t.text||"",l=t.data||[],u=null;switch(e.writeVarInt(o),s){case"sequenceNumber":e.writeUInt8(255),e.writeUInt8(0),e.writeVarInt(2),e.writeUInt16(t.number);break;case"text":e.writeUInt8(255),e.writeUInt8(1),e.writeVarInt(n.length),e.writeString(n);break;case"copyrightNotice":e.writeUInt8(255),e.writeUInt8(2),e.writeVarInt(n.length),e.writeString(n);break;case"trackName":e.writeUInt8(255),e.writeUInt8(3),e.writeVarInt(n.length),e.writeString(n);break;case"instrumentName":e.writeUInt8(255),e.writeUInt8(4),e.writeVarInt(n.length),e.writeString(n);break;case"lyrics":e.writeUInt8(255),e.writeUInt8(5),e.writeVarInt(n.length),e.writeString(n);break;case"marker":e.writeUInt8(255),e.writeUInt8(6),e.writeVarInt(n.length),e.writeString(n);break;case"cuePoint":e.writeUInt8(255),e.writeUInt8(7),e.writeVarInt(n.length),e.writeString(n);break;case"channelPrefix":e.writeUInt8(255),e.writeUInt8(32),e.writeVarInt(1),e.writeUInt8(t.channel);break;case"portPrefix":e.writeUInt8(255),e.writeUInt8(33),e.writeVarInt(1),e.writeUInt8(t.port);break;case"endOfTrack":e.writeUInt8(255),e.writeUInt8(47),e.writeVarInt(0);break;case"setTempo":e.writeUInt8(255),e.writeUInt8(81),e.writeVarInt(3),e.writeUInt24(t.microsecondsPerBeat);break;case"smpteOffset":e.writeUInt8(255),e.writeUInt8(84),e.writeVarInt(5);var f={24:0,25:32,29:64,30:96},S=t.hour&31|f[t.frameRate];e.writeUInt8(S),e.writeUInt8(t.min),e.writeUInt8(t.sec),e.writeUInt8(t.frame),e.writeUInt8(t.subFrame);break;case"timeSignature":e.writeUInt8(255),e.writeUInt8(88),e.writeVarInt(4),e.writeUInt8(t.numerator);var k=Math.floor(Math.log(t.denominator)/Math.LN2)&255;e.writeUInt8(k),e.writeUInt8(t.metronome),e.writeUInt8(t.thirtyseconds||8);break;case"keySignature":e.writeUInt8(255),e.writeUInt8(89),e.writeVarInt(2),e.writeInt8(t.key),e.writeUInt8(t.scale);break;case"sequencerSpecific":e.writeUInt8(255),e.writeUInt8(127),e.writeVarInt(l.length),e.writeBytes(l);break;case"unknownMeta":t.metatypeByte!=null&&(e.writeUInt8(255),e.writeUInt8(t.metatypeByte),e.writeVarInt(l.length),e.writeBytes(l));break;case"sysEx":e.writeUInt8(240),e.writeVarInt(l.length),e.writeBytes(l);break;case"endSysEx":e.writeUInt8(247),e.writeVarInt(l.length),e.writeBytes(l);break;case"noteOff":var m=i!==!1&&t.byte9||i&&t.velocity==0?144:128;u=m|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteOn":u=144|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteAftertouch":u=160|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.amount);break;case"controller":u=176|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.controllerType),e.writeUInt8(t.value);break;case"programChange":u=192|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.programNumber);break;case"channelAftertouch":u=208|t.channel,u!==r&&e.writeUInt8(u),e.writeUInt8(t.amount);break;case"pitchBend":u=224|t.channel,u!==r&&e.writeUInt8(u);var v=8192+t.value,O=v&127,U=v>>7&127;e.writeUInt8(O),e.writeUInt8(U);break;default:throw"Unrecognized event type: "+s}return u}function ht(){this.buffer=[]}ht.prototype.writeUInt8=function(e){this.buffer.push(e&255)};ht.prototype.writeInt8=ht.prototype.writeUInt8;ht.prototype.writeUInt16=function(e){var t=e>>8&255,r=e&255;this.writeUInt8(t),this.writeUInt8(r)};ht.prototype.writeInt16=ht.prototype.writeUInt16;ht.prototype.writeUInt24=function(e){var t=e>>16&255,r=e>>8&255,i=e&255;this.writeUInt8(t),this.writeUInt8(r),this.writeUInt8(i)};ht.prototype.writeInt24=ht.prototype.writeUInt24;ht.prototype.writeUInt32=function(e){var t=e>>24&255,r=e>>16&255,i=e>>8&255,s=e&255;this.writeUInt8(t),this.writeUInt8(r),this.writeUInt8(i),this.writeUInt8(s)};ht.prototype.writeInt32=ht.prototype.writeUInt32;ht.prototype.writeBytes=function(e){this.buffer=this.buffer.concat(Array.prototype.slice.call(e,0))};ht.prototype.writeString=function(e){var t,r=e.length,i=[];for(t=0;t<r;t++)i.push(e.codePointAt(t));this.writeBytes(i)};ht.prototype.writeVarInt=function(e){if(e<0)throw"Cannot write negative variable-length integer";if(e<=127)this.writeUInt8(e);else{var t=e,r=[];for(r.push(t&127),t>>=7;t;){var i=t&127|128;r.push(i),t>>=7}this.writeBytes(r.reverse())}};ht.prototype.writeChunk=function(e,t){this.writeString(e),this.writeUInt32(t.length),this.writeBytes(t)};var mi=li;wr.parseMidi=fi;wr.writeMidi=mi;var ar={},le={};Object.defineProperty(le,"__esModule",{value:!0});le.insert=le.search=void 0;function vn(e,t,r){r===void 0&&(r="ticks");var i=0,s=e.length,o=s;if(s>0&&e[s-1][r]<=t)return s-1;for(;i<o;){var n=Math.floor(i+(o-i)/2),l=e[n],u=e[n+1];if(l[r]===t){for(var f=n;f<e.length;f++){var S=e[f];S[r]===t&&(n=f)}return n}else{if(l[r]<t&&u[r]>t)return n;l[r]>t?o=n:l[r]<t&&(i=n+1)}}return-1}le.search=vn;function bi(e,t,r){if(r===void 0&&(r="ticks"),e.length){var i=vn(e,t[r],r);e.splice(i+1,0,t)}else e.push(t)}le.insert=bi;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.keySignatureKeys=void 0;var t=le,r=new WeakMap;e.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function s(o){var n=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),o){r.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(u){u.forEach(function(f){f.meta&&(f.type==="timeSignature"?n.timeSignatures.push({ticks:f.absoluteTime,timeSignature:[f.numerator,f.denominator]}):f.type==="setTempo"?n.tempos.push({bpm:6e7/f.microsecondsPerBeat,ticks:f.absoluteTime}):f.type==="keySignature"&&n.keySignatures.push({key:e.keySignatureKeys[f.key+7],scale:f.scale===0?"major":"minor",ticks:f.absoluteTime}))})});var l=0;o.tracks[0].forEach(function(u){l+=u.deltaTime,u.meta&&(u.type==="trackName"?n.name=u.text:(u.type==="text"||u.type==="cuePoint"||u.type==="marker"||u.type==="lyrics")&&n.meta.push({text:u.text,ticks:l,type:u.type}))}),this.update()}}return s.prototype.update=function(){var o=this,n=0,l=0;this.tempos.sort(function(u,f){return u.ticks-f.ticks}),this.tempos.forEach(function(u,f){var S=f>0?o.tempos[f-1].bpm:o.tempos[0].bpm,k=u.ticks/o.ppq-l,m=60/S*k;u.time=m+n,n=u.time,l+=k}),this.timeSignatures.sort(function(u,f){return u.ticks-f.ticks}),this.timeSignatures.forEach(function(u,f){var S=f>0?o.timeSignatures[f-1]:o.timeSignatures[0],k=(u.ticks-S.ticks)/o.ppq,m=k/S.timeSignature[0]/(S.timeSignature[1]/4);S.measures=S.measures||0,u.measures=m+S.measures})},s.prototype.ticksToSeconds=function(o){var n=(0,t.search)(this.tempos,o);if(n!==-1){var l=this.tempos[n],u=l.time,f=(o-l.ticks)/this.ppq;return u+60/l.bpm*f}else{var S=o/this.ppq;return 60/120*S}},s.prototype.ticksToMeasures=function(o){var n=(0,t.search)(this.timeSignatures,o);if(n!==-1){var l=this.timeSignatures[n],u=(o-l.ticks)/this.ppq;return l.measures+u/(l.timeSignature[0]/l.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(s.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),s.prototype.secondsToTicks=function(o){var n=(0,t.search)(this.tempos,o,"time");if(n!==-1){var l=this.tempos[n],u=l.time,f=o-u,S=f/(60/l.bpm);return Math.round(l.ticks+S*this.ppq)}else{var k=o/.5;return Math.round(k*this.ppq)}},s.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},s.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(n){return Object.assign({},n)}),this.timeSignatures=o.timeSignatures.map(function(n){return Object.assign({},n)}),this.keySignatures=o.keySignatures.map(function(n){return Object.assign({},n)}),this.meta=o.meta.map(function(n){return Object.assign({},n)}),r.set(this,o.ppq),this.update()},s.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},s}();e.Header=i})(ar);var Me={},Xr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ControlChange=e.controlChangeIds=e.controlChangeNames=void 0,e.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},e.controlChangeIds=Object.keys(e.controlChangeNames).reduce(function(s,o){return s[e.controlChangeNames[o]]=o,s},{});var t=new WeakMap,r=new WeakMap,i=function(){function s(o,n){t.set(this,n),r.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(s.prototype,"number",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"name",{get:function(){return e.controlChangeNames[this.number]?e.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){var o=t.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var n=t.get(this);this.ticks=n.secondsToTicks(o)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},s}();e.ControlChange=i})(Xr);var kr={};Object.defineProperty(kr,"__esModule",{value:!0});kr.createControlChanges=void 0;var $e=Xr;function yi(){return new Proxy({},{get:function(e,t){if(e[t])return e[t];if($e.controlChangeIds.hasOwnProperty(t))return e[$e.controlChangeIds[t]]},set:function(e,t,r){return $e.controlChangeIds.hasOwnProperty(t)?e[$e.controlChangeIds[t]]=r:e[t]=r,!0}})}kr.createControlChanges=yi;var _r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.PitchBend=void 0;var Lr=new WeakMap,vi=function(){function e(t,r){Lr.set(this,r),this.ticks=t.absoluteTime,this.value=t.value}return Object.defineProperty(e.prototype,"time",{get:function(){var t=Lr.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var r=Lr.get(this);this.ticks=r.secondsToTicks(t)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}();_r.PitchBend=vi;var Ir={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.DrumKitByPatchID=oe.InstrumentFamilyByID=oe.instrumentByPatchID=void 0;oe.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];oe.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];oe.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Object.defineProperty(Ir,"__esModule",{value:!0});Ir.Instrument=void 0;var Ze=oe,hn=new WeakMap,gi=function(){function e(t,r){if(this.number=0,hn.set(this,r),this.number=0,t){var i=t.find(function(s){return s.type==="programChange"});i&&(this.number=i.programNumber)}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.percussion?Ze.DrumKitByPatchID[this.number]:Ze.instrumentByPatchID[this.number]},set:function(t){var r=Ze.instrumentByPatchID.indexOf(t);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"family",{get:function(){return this.percussion?"drums":Ze.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"percussion",{get:function(){var t=hn.get(this);return t.channel===9},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},e.prototype.fromJSON=function(t){this.number=t.number},e}();Ir.Instrument=gi;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.Note=void 0;function xi(e){var t=Math.floor(e/12)-1;return gn(e)+t.toString()}function gn(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=e%12;return t[r]}function wi(e){var t=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return t.indexOf(e)}var ki=function(){var e=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,t={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(r){var i=e.exec(r),s=i[1],o=i[2],n=t[s.toLowerCase()];return n+(parseInt(o,10)+1)*12}}(),be=new WeakMap,_i=function(){function e(t,r,i){be.set(this,i),this.midi=t.midi,this.velocity=t.velocity,this.noteOffVelocity=r.velocity,this.ticks=t.ticks,this.durationTicks=r.ticks-t.ticks}return Object.defineProperty(e.prototype,"name",{get:function(){return xi(this.midi)},set:function(t){this.midi=ki(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(t){var r=t-this.octave;this.midi+=r*12},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return gn(this.midi)},set:function(t){this.midi=12*(this.octave+1)+wi(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var t=be.get(this);return t.ticksToSeconds(this.ticks+this.durationTicks)-t.ticksToSeconds(this.ticks)},set:function(t){var r=be.get(this),i=r.secondsToTicks(this.time+t);this.durationTicks=i-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){var t=be.get(this);return t.ticksToSeconds(this.ticks)},set:function(t){var r=be.get(this);this.ticks=r.secondsToTicks(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bars",{get:function(){var t=be.get(this);return t.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},e}();Tr.Note=_i;Object.defineProperty(Me,"__esModule",{value:!0});Me.Track=void 0;var Rr=le,Ii=Xr,Ti=kr,Si=_r,dn=Ir,Oi=Tr,Qe=new WeakMap,Bi=function(){function e(t,r){var i=this;if(this.name="",this.notes=[],this.controlChanges=(0,Ti.createControlChanges)(),this.pitchBends=[],Qe.set(this,r),t){var s=t.find(function(m){return m.type==="trackName"});this.name=s?s.text:""}if(this.instrument=new dn.Instrument(t,this),this.channel=0,t){for(var o=t.filter(function(m){return m.type==="noteOn"}),n=t.filter(function(m){return m.type==="noteOff"}),l=function(){var m=o.shift();u.channel=m.channel;var v=n.findIndex(function(U){return U.noteNumber===m.noteNumber&&U.absoluteTime>=m.absoluteTime});if(v!==-1){var O=n.splice(v,1)[0];u.addNote({durationTicks:O.absoluteTime-m.absoluteTime,midi:m.noteNumber,noteOffVelocity:O.velocity/127,ticks:m.absoluteTime,velocity:m.velocity/127})}},u=this;o.length;)l();var f=t.filter(function(m){return m.type==="controller"});f.forEach(function(m){i.addCC({number:m.controllerType,ticks:m.absoluteTime,value:m.value/127})});var S=t.filter(function(m){return m.type==="pitchBend"});S.forEach(function(m){i.addPitchBend({ticks:m.absoluteTime,value:m.value/Math.pow(2,13)})});var k=t.find(function(m){return m.type==="endOfTrack"});this.endOfTrackTicks=k!==void 0?k.absoluteTime:void 0}}return e.prototype.addNote=function(t){var r=Qe.get(this),i=new Oi.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},r);return Object.assign(i,t),(0,Rr.insert)(this.notes,i,"ticks"),this},e.prototype.addCC=function(t){var r=Qe.get(this),i=new Ii.ControlChange({controllerType:t.number},r);return delete t.number,Object.assign(i,t),Array.isArray(this.controlChanges[i.number])||(this.controlChanges[i.number]=[]),(0,Rr.insert)(this.controlChanges[i.number],i,"ticks"),this},e.prototype.addPitchBend=function(t){var r=Qe.get(this),i=new Si.PitchBend({},r);return Object.assign(i,t),(0,Rr.insert)(this.pitchBends,i,"ticks"),this},Object.defineProperty(e.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,r=0;r<this.notes.length-1;r++){var i=this.notes[r].time+this.notes[r].duration;t<i&&(t=i)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var t=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,r=0;r<this.notes.length-1;r++){var i=this.notes[r].ticks+this.notes[r].durationTicks;t<i&&(t=i)}return t},enumerable:!1,configurable:!0}),e.prototype.fromJSON=function(t){var r=this;this.name=t.name,this.channel=t.channel,this.instrument=new dn.Instrument(void 0,this),this.instrument.fromJSON(t.instrument),t.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=t.endOfTrackTicks);for(var i in t.controlChanges)t.controlChanges[i]&&t.controlChanges[i].forEach(function(s){r.addCC({number:s.number,ticks:s.ticks,value:s.value})});t.notes.forEach(function(s){r.addNote({durationTicks:s.durationTicks,midi:s.midi,ticks:s.ticks,velocity:s.velocity})})},e.prototype.toJSON=function(){for(var t={},r=0;r<127;r++)this.controlChanges.hasOwnProperty(r)&&(t[r]=this.controlChanges[r].map(function(s){return s.toJSON()}));var i={channel:this.channel,controlChanges:t,pitchBends:this.pitchBends.map(function(s){return s.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(s){return s.toJSON()})};return this.endOfTrackTicks!==void 0&&(i.endOfTrackTicks=this.endOfTrackTicks),i},e}();Me.Track=Bi;var Sr={};function Ui(e){var t=[];return xn(e,t),t}function xn(e,t){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?xn(i,t):t.push(i)}}const Ei=Object.freeze(Object.defineProperty({__proto__:null,flatten:Ui},Symbol.toStringTag,{value:"Module"})),Ni=si(Ei);var ie=ye&&ye.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var i=0,s=t.length,o;i<s;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.encode=void 0;var Ci=wr,Fi=ar,Mi=Ni;function Ai(e,t){return[{absoluteTime:e.ticks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOn",velocity:Math.floor(e.velocity*127)},{absoluteTime:e.ticks+e.durationTicks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOff",velocity:Math.floor(e.noteOffVelocity*127)}]}function Pi(e){return(0,Mi.flatten)(e.notes.map(function(t){return Ai(t,e.channel)}))}function Di(e,t){return{absoluteTime:e.ticks,channel:t,controllerType:e.number,deltaTime:0,type:"controller",value:Math.floor(e.value*127)}}function Li(e){for(var t=[],r=0;r<127;r++)e.controlChanges.hasOwnProperty(r)&&e.controlChanges[r].forEach(function(i){t.push(Di(i,e.channel))});return t}function Ri(e,t){return{absoluteTime:e.ticks,channel:t,deltaTime:0,type:"pitchBend",value:e.value}}function ji(e){var t=[];return e.pitchBends.forEach(function(r){t.push(Ri(r,e.channel))}),t}function Hi(e){return{absoluteTime:0,channel:e.channel,deltaTime:0,programNumber:e.instrument.number,type:"programChange"}}function Vi(e){return{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}}function qi(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/e.bpm),type:"setTempo"}}function Ji(e){return{absoluteTime:e.ticks,deltaTime:0,denominator:e.timeSignature[1],meta:!0,metronome:24,numerator:e.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function Wi(e){var t=Fi.keySignatureKeys.indexOf(e.key);return{absoluteTime:e.ticks,deltaTime:0,key:t+7,meta:!0,scale:e.scale==="major"?0:1,type:"keySignature"}}function Gi(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,text:e.text,type:e.type}}function zi(e){var t={header:{format:1,numTracks:e.tracks.length+1,ticksPerBeat:e.header.ppq},tracks:ie([ie(ie(ie(ie([{absoluteTime:0,deltaTime:0,meta:!0,text:e.header.name,type:"trackName"}],e.header.keySignatures.map(function(r){return Wi(r)}),!0),e.header.meta.map(function(r){return Gi(r)}),!0),e.header.tempos.map(function(r){return qi(r)}),!0),e.header.timeSignatures.map(function(r){return Ji(r)}),!0)],e.tracks.map(function(r){return ie(ie(ie([Vi(r.name),Hi(r)],Pi(r),!0),Li(r),!0),ji(r),!0)}),!0)};return t.tracks=t.tracks.map(function(r){r=r.sort(function(s,o){return s.absoluteTime-o.absoluteTime});var i=0;return r.forEach(function(s){s.deltaTime=s.absoluteTime-i,i=s.absoluteTime,delete s.absoluteTime}),r.push({deltaTime:0,meta:!0,type:"endOfTrack"}),r}),new Uint8Array((0,Ci.writeMidi)(t))}Sr.encode=zi;(function(e){var t=ye&&ye.__awaiter||function(k,m,v,O){function U(_){return _ instanceof v?_:new v(function(J){J(_)})}return new(v||(v=Promise))(function(_,J){function H(g){try{h(O.next(g))}catch(B){J(B)}}function V(g){try{h(O.throw(g))}catch(B){J(B)}}function h(g){g.done?_(g.value):U(g.value).then(H,V)}h((O=O.apply(k,m||[])).next())})},r=ye&&ye.__generator||function(k,m){var v={label:0,sent:function(){if(_[0]&1)throw _[1];return _[1]},trys:[],ops:[]},O,U,_,J;return J={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(J[Symbol.iterator]=function(){return this}),J;function H(h){return function(g){return V([h,g])}}function V(h){if(O)throw new TypeError("Generator is already executing.");for(;v;)try{if(O=1,U&&(_=h[0]&2?U.return:h[0]?U.throw||((_=U.return)&&_.call(U),0):U.next)&&!(_=_.call(U,h[1])).done)return _;switch(U=0,_&&(h=[h[0]&2,_.value]),h[0]){case 0:case 1:_=h;break;case 4:return v.label++,{value:h[1],done:!1};case 5:v.label++,U=h[1],h=[0];continue;case 7:h=v.ops.pop(),v.trys.pop();continue;default:if(_=v.trys,!(_=_.length>0&&_[_.length-1])&&(h[0]===6||h[0]===2)){v=0;continue}if(h[0]===3&&(!_||h[1]>_[0]&&h[1]<_[3])){v.label=h[1];break}if(h[0]===6&&v.label<_[1]){v.label=_[1],_=h;break}if(_&&v.label<_[2]){v.label=_[2],v.ops.push(h);break}_[2]&&v.ops.pop(),v.trys.pop();continue}h=m.call(k,v)}catch(g){h=[6,g],U=0}finally{O=_=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Header=e.Track=e.Midi=void 0;var i=wr,s=ar,o=Me,n=Sr,l=function(){function k(m){var v=this,O=null;if(m){var U=m instanceof ArrayBuffer?new Uint8Array(m):m;O=(0,i.parseMidi)(U),O.tracks.forEach(function(_){var J=0;_.forEach(function(H){J+=H.deltaTime,H.absoluteTime=J})}),O.tracks=S(O.tracks)}this.header=new s.Header(O),this.tracks=[],m&&(this.tracks=O.tracks.map(function(_){return new o.Track(_,v.header)}),O.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return k.fromUrl=function(m){return t(this,void 0,void 0,function(){var v,O;return r(this,function(U){switch(U.label){case 0:return[4,fetch(m)];case 1:return v=U.sent(),v.ok?[4,v.arrayBuffer()]:[3,3];case 2:return O=U.sent(),[2,new k(O)];case 3:throw new Error("Could not load '".concat(m,"'"))}})})},Object.defineProperty(k.prototype,"name",{get:function(){return this.header.name},set:function(m){this.header.name=m},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"duration",{get:function(){var m=this.tracks.map(function(v){return v.duration});return Math.max.apply(Math,m)},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"durationTicks",{get:function(){var m=this.tracks.map(function(v){return v.durationTicks});return Math.max.apply(Math,m)},enumerable:!1,configurable:!0}),k.prototype.addTrack=function(){var m=new o.Track(void 0,this.header);return this.tracks.push(m),m},k.prototype.toArray=function(){return(0,n.encode)(this)},k.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(m){return m.toJSON()})}},k.prototype.fromJSON=function(m){var v=this;this.header=new s.Header,this.header.fromJSON(m.header),this.tracks=m.tracks.map(function(O){var U=new o.Track(void 0,v.header);return U.fromJSON(O),U})},k.prototype.clone=function(){var m=new k;return m.fromJSON(this.toJSON()),m},k}();e.Midi=l;var u=Me;Object.defineProperty(e,"Track",{enumerable:!0,get:function(){return u.Track}});var f=ar;Object.defineProperty(e,"Header",{enumerable:!0,get:function(){return f.Header}});function S(k){for(var m=[],v=0;v<k.length;v++)for(var O=m.length,U=new Map,_=Array(16).fill(0),J=0,H=k[v];J<H.length;J++){var V=H[J],h=O,g=V.channel;if(g!==void 0){V.type==="programChange"&&(_[g]=V.programNumber);var B=_[g],q="".concat(B," ").concat(g);U.has(q)?h=U.get(q):(h=O+U.size,U.set(q,h))}m[h]||m.push([]),m[h].push(V)}return m}})(ir);class Yi extends Number{constructor(t){const[r]=new Int8Array([t]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Byte"}}class er extends Number{constructor(t){const[r]=new Int16Array([t]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Short"}}class fe extends Number{constructor(t){const[r]=new Int32Array([t]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Int"}}class Xi extends Number{constructor(t){const[r]=new Float32Array([t]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Float"}}class Le{constructor(t,{name:r,endian:i,compression:s,bedrockLevel:o}={}){if(t instanceof Le&&(r===void 0&&(r=t.name),i===void 0&&(i=t.endian),s===void 0&&(s=t.compression),o===void 0&&(o=t.bedrockLevel),t=t.data),r===void 0&&(r=""),i===void 0&&(i="big"),s===void 0&&(s=null),o===void 0&&(o=null),typeof t!="object"||t===null)throw new TypeError("First parameter must be an object");if(typeof r!="string"&&r!==null)throw new TypeError("Name option must be a string or null");if(i!=="big"&&i!=="little")throw new TypeError("Endian option must be a valid endian type");if(s!==null&&s!=="gzip"&&s!=="deflate")throw new TypeError("Compression option must be a valid compression type");if(o!==null&&!(o instanceof fe))throw new TypeError("Bedrock Level option must be an Int");this.data=t,this.name=r,this.endian=i,s!==null&&(this.compression=s),o!==null&&(this.bedrockLevel=o),Object.freeze(this)}get[Symbol.toStringTag](){return"NBTData"}}const $={END:0,BYTE:1,SHORT:2,INT:3,LONG:4,FLOAT:5,DOUBLE:6,BYTE_ARRAY:7,STRING:8,LIST:9,COMPOUND:10,INT_ARRAY:11,LONG_ARRAY:12};Object.freeze($);function Ne(e){switch(!0){case e instanceof Yi:case typeof e=="boolean":return $.BYTE;case e instanceof er:return $.SHORT;case e instanceof fe:return $.INT;case typeof e=="bigint":return $.LONG;case e instanceof Xi:return $.FLOAT;case typeof e=="number":return $.DOUBLE;case e instanceof Int8Array:return $.BYTE_ARRAY;case typeof e=="string":return $.STRING;case e instanceof Array:return $.LIST;case e instanceof Int32Array:return $.INT_ARRAY;case e instanceof BigInt64Array:return $.LONG_ARRAY;case(typeof e=="object"&&e!==null):return $.COMPOUND;default:return null}}async function pn(e,{format:t="gzip"}={}){const r=new CompressionStream(t),i=new Blob([e]).stream().pipeThrough(r),s=await new Response(i).arrayBuffer();return new Uint8Array(s)}async function Ki(e,{name:t,endian:r,compression:i,bedrockLevel:s}={}){if(e instanceof Le&&(t===void 0&&(t=e.name),r===void 0&&(r=e.endian),i===void 0&&(i=e.compression),s===void 0&&(s=e.bedrockLevel),e=e.data),typeof e!="object"||e===null)throw new TypeError("First parameter must be an object");if(t!==void 0&&typeof t!="string"&&t!==null)throw new TypeError("Name option must be a string or null");if(r!==void 0&&r!=="big"&&r!=="little")throw new TypeError("Endian option must be a valid endian type");if(i!=null&&i!=="gzip"&&i!=="deflate")throw new TypeError("Compression option must be a valid compression type");if(s!=null&&!(s instanceof fe))throw new TypeError("Bedrock Level option must be an Int");let n=new $i().write(e,{name:t,endian:r});if(s!=null){const{byteLength:l}=n,u=new Uint8Array(l+8),f=new DataView(u.buffer),S=s.valueOf();f.setUint32(0,S,!0),f.setUint32(4,l,!0),u.set(n,8),n=u}return i==="gzip"&&(n=await pn(n,{format:"gzip"})),i==="deflate"&&(n=await pn(n,{format:"deflate"})),n}var K,Kt,Dt,Lt,cr,Bt,Ht,Ae,Vr,ue,Ce,ur,wn,fr,kn,lr,_n,hr,In,re,ce,Pe,qr,dr,Tn,pr,Sn,mr,On,ge,rr,br,Bn,De,Jr,yr,Un,vr,En;class $i{constructor(){ot(this,Bt);ot(this,Ae);ot(this,ue);ot(this,ur);ot(this,fr);ot(this,lr);ot(this,hr);ot(this,re);ot(this,Pe);ot(this,dr);ot(this,pr);ot(this,mr);ot(this,ge);ot(this,br);ot(this,De);ot(this,yr);ot(this,vr);ot(this,K,void 0);ot(this,Kt,void 0);ot(this,Dt,void 0);ot(this,Lt,void 0);ot(this,cr,new TextEncoder)}write(t,{name:r,endian:i}={}){if(t instanceof Le&&(r===void 0&&(r=t.name),i===void 0&&(i=t.endian),t=t.data),r===void 0&&(r=""),i===void 0&&(i="big"),typeof t!="object"||t===null)throw new TypeError("First parameter must be an object");if(typeof r!="string"&&r!==null)throw new TypeError("Name option must be a string or null");if(i!=="big"&&i!=="little")throw new TypeError("Endian option must be a valid endian type");return gt(this,K,0),gt(this,Kt,i==="little"),gt(this,Dt,new Uint8Array(1024)),gt(this,Lt,new DataView(E(this,Dt).buffer)),F(this,ue,Ce).call(this,$.COMPOUND),r!==null&&F(this,ge,rr).call(this,r),F(this,De,Jr).call(this,t),F(this,Bt,Ht).call(this,0),E(this,Dt).slice(0,E(this,K))}}K=new WeakMap,Kt=new WeakMap,Dt=new WeakMap,Lt=new WeakMap,cr=new WeakMap,Bt=new WeakSet,Ht=function(t){const r=E(this,K)+t;if(E(this,Dt).byteLength>=r)return;let i=E(this,Dt).byteLength;for(;i<r;)i*=2;const s=new Uint8Array(i);s.set(E(this,Dt),0),E(this,K)>E(this,Dt).byteLength&&s.fill(0,t,E(this,K)),gt(this,Dt,s),gt(this,Lt,new DataView(s.buffer))},Ae=new WeakSet,Vr=function(t){switch(Ne(t)){case $.BYTE:return F(this,fr,kn).call(this,Number(t));case $.SHORT:return F(this,hr,In).call(this,t.valueOf());case $.INT:return F(this,re,ce).call(this,t.valueOf());case $.LONG:return F(this,Pe,qr).call(this,t);case $.FLOAT:return F(this,dr,Tn).call(this,t.valueOf());case $.DOUBLE:return F(this,pr,Sn).call(this,t);case $.BYTE_ARRAY:return F(this,mr,On).call(this,t);case $.STRING:return F(this,ge,rr).call(this,t);case $.LIST:return F(this,br,Bn).call(this,t);case $.COMPOUND:return F(this,De,Jr).call(this,t);case $.INT_ARRAY:return F(this,yr,Un).call(this,t);case $.LONG_ARRAY:return F(this,vr,En).call(this,t)}},ue=new WeakSet,Ce=function(t){F(this,ur,wn).call(this,t)},ur=new WeakSet,wn=function(t){F(this,Bt,Ht).call(this,1),E(this,Lt).setUint8(E(this,K),t),gt(this,K,E(this,K)+1)},fr=new WeakSet,kn=function(t){F(this,Bt,Ht).call(this,1),E(this,Lt).setInt8(E(this,K),t),gt(this,K,E(this,K)+1)},lr=new WeakSet,_n=function(t){F(this,Bt,Ht).call(this,2),E(this,Lt).setUint16(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+2)},hr=new WeakSet,In=function(t){F(this,Bt,Ht).call(this,2),E(this,Lt).setInt16(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+2)},re=new WeakSet,ce=function(t){F(this,Bt,Ht).call(this,4),E(this,Lt).setInt32(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+4)},Pe=new WeakSet,qr=function(t){F(this,Bt,Ht).call(this,8),E(this,Lt).setBigInt64(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+8)},dr=new WeakSet,Tn=function(t){F(this,Bt,Ht).call(this,4),E(this,Lt).setFloat32(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+4)},pr=new WeakSet,Sn=function(t){F(this,Bt,Ht).call(this,8),E(this,Lt).setFloat64(E(this,K),t,E(this,Kt)),gt(this,K,E(this,K)+8)},mr=new WeakSet,On=function(t){const{length:r}=t;F(this,re,ce).call(this,r),F(this,Bt,Ht).call(this,r),E(this,Dt).set(t,E(this,K)),gt(this,K,E(this,K)+r)},ge=new WeakSet,rr=function(t){const r=E(this,cr).encode(t),{length:i}=r;F(this,lr,_n).call(this,i),F(this,Bt,Ht).call(this,i),E(this,Dt).set(r,E(this,K)),gt(this,K,E(this,K)+i)},br=new WeakSet,Bn=function(t){t=t.filter(s=>Ne(s)!==null);const r=t.length!==0?Ne(t[0]):$.END,{length:i}=t;F(this,ue,Ce).call(this,r),F(this,re,ce).call(this,i);for(const s of t){if(Ne(s)!==r)throw new TypeError("Encountered unexpected item type in array, all tags in a List tag must be of the same type");F(this,Ae,Vr).call(this,s)}},De=new WeakSet,Jr=function(t){for(const[r,i]of Object.entries(t)){const s=Ne(i);s!==null&&(F(this,ue,Ce).call(this,s),F(this,ge,rr).call(this,r),F(this,Ae,Vr).call(this,i))}F(this,ue,Ce).call(this,$.END)},yr=new WeakSet,Un=function(t){const{length:r}=t;F(this,re,ce).call(this,r);for(const i of t)F(this,re,ce).call(this,i)},vr=new WeakSet,En=function(t){const{length:r}=t;F(this,re,ce).call(this,r);for(const i of t)F(this,Pe,qr).call(this,i)};const Jt=class{constructor(t){zt(this,"name");zt(this,"index");this.name=t,this.index=Jt.maxTags}static create(t){if(Jt.palette[t])return Jt.blocks[Jt.palette[t].valueOf()];const r=new Jt(t);return Jt.maxTags+=1,Jt.blocks.push(r),Jt.palette[r.name]=new fe(r.index),r}static get(t){return Jt.blocks[t]}};let it=Jt;zt(it,"maxTags",0),zt(it,"blocks",[]),zt(it,"palette",{});class Zi{constructor(t,r,i,s){zt(this,"width");zt(this,"height");zt(this,"length");zt(this,"blockData");this.width=new er(t),this.height=new er(r),this.length=new er(i),this.blockData=new Int8Array(t*r*i).fill(s.index)}positionToIndex(t,r,i){return t+i*this.width.valueOf()+r*this.width.valueOf()*this.length.valueOf()}setBlock(t,r,i,s){this.blockData[this.positionToIndex(t,r,i)]=s.index.valueOf()}getBlock(t,r,i){return this.blockData[this.positionToIndex(t,r,i)]}get Width(){return this.width.valueOf()}get Height(){return this.height.valueOf()}get Length(){return this.length.valueOf()}toNBT(){const t={Version:new fe(2),DataVersion:new fe(2975),Width:this.width,Height:this.height,Length:this.length,BlockData:this.blockData,PaletteMax:new fe(it.maxTags),Palette:it.palette};return new Le(t,{name:"Schematic"})}}const Wr=it.create("minecraft:air"),sr=it.create("minecraft:repeater[facing=north]"),ve=it.create("minecraft:white_concrete"),Et=it.create("minecraft:redstone_wire"),Gr=it.create("minecraft:observer[facing=down]"),Qi=it.create("minecraft:observer[facing=up]"),ta=it.create("minecraft:powered_rail[shape=east_west]"),zr=it.create("minecraft:redstone_block"),or=it.create("minecraft:redstone_lamp"),ea=it.create("minecraft:sticky_piston[facing=south]"),ra=it.create("minecraft:sticky_piston[facing=down]"),na=it.create("minecraft:lever[face=floor]"),ia=[it.create("minecraft:oak_planks"),it.create("minecraft:white_wool"),it.create("minecraft:dirt"),it.create("minecraft:clay"),it.create("minecraft:gold_block")],ae=15,Wt=Math.floor(ae/2),_t=5,nt=7,aa=e=>{for(let t=0;t<e.Width;t++)for(let r=0;r<e.Length;r++)e.setBlock(t,0,r,ve),e.setBlock(t,6,r,ve)},sa=(e,t,r)=>{const i=(_t+nt)%2;for(let s=0;s<e.Length;s++)s>=_t+nt&&(s%2==i?(e.setBlock(t+1+r,1,s,sr),e.setBlock(t-1+r,1,s,sr)):(e.setBlock(t+1+r,1,s,or),e.setBlock(t-1+r,1,s,or)))},oa=(e,t,r)=>{const i=(_t+nt)%2;for(let s=_t+nt;s<e.Length;s++)s%2!==i?e.setBlock(t+1+r,2,s,Gr):e.setBlock(t-1+r,2,s,Gr)},ca=e=>{for(let t=_t+nt;t<e.Length;t++)for(let r=0;r<e.Width;r++)e.setBlock(r,3,t,ve),e.setBlock(r,4,t,ta),e.setBlock(r,5,t,Gr)},ua=(e,t)=>{for(let r=_t+nt;r<e.Length;r++)e.setBlock(t,7,r,or)},jr=(e,t,r)=>{sa(e,t,r),oa(e,t,r),la(e,r+Wt),ha(e,r+Wt),e.setBlock(r+Wt+1,1,nt,Et),e.setBlock(r+Wt-0,1,nt,Et),e.setBlock(r+Wt-1,1,nt,Et),e.setBlock(r+Wt-0,1,nt-1,sr)},fa=(e,t)=>{e.setBlock(t,7,_t,na),e.setBlock(t,6,_t,or),e.setBlock(t,5,_t,Qi),e.setBlock(t,4,_t,Et),e.setBlock(t,3,_t,ra),e.setBlock(t,2,_t,zr),e.setBlock(t,2,_t,zr);for(let r=0;r<=14;r++)e.setBlock(t-1-r,1,_t,Et),e.setBlock(t+1+r,1,_t,Et)},la=(e,t)=>{e.setBlock(t+1,1,nt+1,sr),e.setBlock(t+1,1,nt+2,Et),e.setBlock(t+1,1,nt+3,Et),e.setBlock(t+1,1,nt+4,Et)},ha=(e,t)=>{e.setBlock(t-2,1,nt,Et),e.setBlock(t-2,1,nt+1,ve),e.setBlock(t-2,2,nt+1,Et),e.setBlock(t-2,2,nt+2,ea),e.setBlock(t-2,2,nt+3,ve),e.setBlock(t-2,1,nt+3,Et),e.setBlock(t-2,0,nt+3,zr),e.setBlock(t-1,1,nt+3,ve),e.setBlock(t-1,2,nt+3,Et),e.setBlock(t-1,1,nt+4,Et)},Nn=e=>Math.round(e*20),da=(e,t,r,i,s)=>{let o=Math.round((1-r.velocity)*t);const n=Nn(r.time)+s+nt,l=it.create(`minecraft:note_block[note=${r.midi-54}]`),u=o>t/2?-1:1;for(;o>0&&o<=t;){if(e.getBlock(t+o,7,n)===Wr.index){e.setBlock(t+o,7,n,l),e.setBlock(t+o,6,n,i);break}else if(e.getBlock(t-o,7,n)===Wr.index){e.setBlock(t-o,7,n+1,l),e.setBlock(t-o,6,n+1,i);break}o+=u}},pa=(e,t,r)=>{r.tracks.forEach((i,s)=>{i.notes.forEach(o=>{da(e,t,o,ia[s],_t)})})},ma=e=>{const t=new Zi(ae*3,8,Nn(e.duration+1),Wr);return aa(t),ca(t),jr(t,Wt,ae*0),jr(t,Wt,ae*1),jr(t,Wt,ae*2),ua(t,ae+Wt),pa(t,ae*3,e),fa(t,Wt+ae),t.toNBT()},tr=[6,30,54,78,102,126],ba=e=>{const t=new ir.Midi;for(let r=0;r<tr.length-1;r++){const i=54-tr[r],s=new ir.Track([],e.header);for(const o of e.tracks)for(const n of o.notes)tr[r]<n.midi&&n.midi<=tr[r+1]&&(n.midi+=i,s.addNote(n));t.tracks.push(s)}return t};var Cn={exports:{}},nr={exports:{}};(function(){var e=[],t=3988292384;function r(){var n,l,u;for(l=0;l<256;l+=1){for(n=l,u=0;u<8;u+=1)n&1?n=t^n>>>1:n=n>>>1;e[l]=n>>>0}}function i(n){return Array.prototype.map.call(n,function(l){return l.charCodeAt(0)})}function s(n){var l=-1,u,f,S,k;for(u=0,S=n.length;u<S;u+=1){for(k=(l^n[u])&255,f=0;f<8;f+=1)(k&1)===1?k=k>>>1^t:k=k>>>1;l=l>>>8^k}return l^-1}function o(n,l){var u,f,S;if(!((typeof o.crc>"u"||!l||!n)&&(o.crc=-1,!n))){for(u=o.crc,f=0,S=n.length;f<S;f+=1)u=u>>>8^e[(u^n[f])&255];return o.crc=u,u^-1}}r(),nr.exports=function(u,l){var u=typeof u=="string"?i(u):u,f=l?s(u):o(u);return(f>>>0).toString(16)},nr.exports.direct=s,nr.exports.table=o})();var ya=nr.exports,Fn={exports:{}},Mn={exports:{}};(function(){var e=32768,t=0,r=1,i=2,s=9,o=6,n,l,u=null,f,S,k,m,v,O,U,_,J,H,V,h,g,B,q,G=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],ct=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],dt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],It=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Tt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function xe(){this.next=null,this.list=null}function he(){this.e=0,this.b=0,this.n=0,this.t=null}function $t(D,L,M,d,x,C){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var Nt,ut=[],z,et,N,R,w,I,Ct,Ft=[],ft,yt,Mt,X=new he,wt=[],At=[],st,rt=[],vt,mt,bt,lt,Y;for(Y=this.root=null,w=0;w<this.BMAX+1;w++)ut[w]=0;for(w=0;w<this.BMAX+1;w++)Ft[w]=0;for(w=0;w<this.BMAX;w++)wt[w]=null;for(w=0;w<this.N_MAX;w++)At[w]=0;for(w=0;w<this.BMAX+1;w++)rt[w]=0;z=L>256?D[256]:this.BMAX,ft=D,yt=0,w=L;do ut[ft[yt]]++,yt++;while(--w>0);if(ut[0]===L){this.root=null,this.m=0,this.status=0;return}for(I=1;I<=this.BMAX&&ut[I]===0;I++);for(Ct=I,C<I&&(C=I),w=this.BMAX;w!==0&&ut[w]===0;w--);for(N=w,C>w&&(C=w),mt=1<<I;I<w;I++,mt<<=1)if((mt-=ut[I])<0){this.status=2,this.m=C;return}if((mt-=ut[w])<0){this.status=2,this.m=C;return}for(ut[w]+=mt,rt[1]=I=0,ft=ut,yt=1,vt=2;--w>0;)rt[vt++]=I+=ft[yt++];ft=D,yt=0,w=0;do(I=ft[yt++])!==0&&(At[rt[I]++]=w);while(++w<L);for(L=rt[N],rt[0]=w=0,ft=At,yt=0,R=-1,st=Ft[0]=0,Mt=null,bt=0,null;Ct<=N;Ct++)for(Nt=ut[Ct];Nt-- >0;){for(;Ct>st+Ft[1+R];){if(st+=Ft[1+R],R++,bt=(bt=N-st)>C?C:bt,(et=1<<(I=Ct-st))>Nt+1)for(et-=Nt+1,vt=Ct;++I<bt&&!((et<<=1)<=ut[++vt]);)et-=ut[vt];for(st+I>z&&st<z&&(I=z-st),bt=1<<I,Ft[1+R]=I,Mt=[],lt=0;lt<bt;lt++)Mt[lt]=new he;Y?Y=Y.next=new xe:Y=this.root=new xe,Y.next=null,Y.list=Mt,wt[R]=Mt,R>0&&(rt[R]=w,X.b=Ft[R],X.e=16+I,X.t=Mt,I=(w&(1<<st)-1)>>st-Ft[R],wt[R-1][I].e=X.e,wt[R-1][I].b=X.b,wt[R-1][I].n=X.n,wt[R-1][I].t=X.t)}for(X.b=Ct-st,yt>=L?X.e=99:ft[yt]<M?(X.e=ft[yt]<256?16:15,X.n=ft[yt++]):(X.e=x[ft[yt]-M],X.n=d[ft[yt++]-M]),et=1<<Ct-st,I=w>>st;I<bt;I+=et)Mt[I].e=X.e,Mt[I].b=X.b,Mt[I].n=X.n,Mt[I].t=X.t;for(I=1<<Ct-1;w&I;I>>=1)w^=I;for(w^=I;(w&(1<<st)-1)!==rt[R];)st-=Ft[R],R--}this.m=Ft[1],this.status=mt!==0&&N!==1?1:0}function Zt(){return B.length===q?-1:B[q++]&255}function P(D){for(;v<D;)m|=Zt()<<v,v+=8}function at(D){return m&G[D]}function tt(D){m>>=D,v-=D}function jt(D,L,M){var d,x,C;if(M===0)return 0;for(C=0;;){for(P(h),x=H.list[at(h)],d=x.e;d>16;){if(d===99)return-1;tt(x.b),d-=16,P(d),x=x.t[at(d)],d=x.e}if(tt(x.b),d===16){if(l&=e-1,D[L+C++]=n[l++]=x.n,C===M)return M;continue}if(d===15)break;for(P(d),_=x.n+at(d),tt(d),P(g),x=V.list[at(g)],d=x.e;d>16;){if(d===99)return-1;tt(x.b),d-=16,P(d),x=x.t[at(d)],d=x.e}for(tt(x.b),P(d),J=l-x.n-at(d),tt(d);_>0&&C<M;)_--,J&=e-1,l&=e-1,D[L+C++]=n[l++]=n[J++];if(C===M)return M}return O=-1,C}function xt(D,L,M){var d;if(d=v&7,tt(d),P(16),d=at(16),tt(16),P(16),d!==(~m&65535))return-1;for(tt(16),_=d,d=0;_>0&&d<M;)_--,l&=e-1,P(8),D[L+d++]=n[l++]=at(8),tt(8);return _===0&&(O=-1),d}function pt(D,L,M){if(!u){var d,x=[],C;for(d=0;d<144;d++)x[d]=8;for(null;d<256;d++)x[d]=9;for(null;d<280;d++)x[d]=7;for(null;d<288;d++)x[d]=8;if(S=7,C=new $t(x,288,257,ct,dt,S),C.status!==0)return console.error("HufBuild error: "+C.status),-1;for(u=C.root,S=C.m,d=0;d<30;d++)x[d]=5;if(k=5,C=new $t(x,30,0,It,Tt,k),C.status>1)return u=null,console.error("HufBuild error: "+C.status),-1;f=C.root,k=C.m}return H=u,V=f,h=S,g=k,jt(D,L,M)}function de(D,L,M){var d,x,C,Nt,ut,z,et,N,R=[],w;for(d=0;d<286+30;d++)R[d]=0;if(P(5),et=257+at(5),tt(5),P(5),N=1+at(5),tt(5),P(4),z=4+at(4),tt(4),et>286||N>30)return-1;for(x=0;x<z;x++)P(3),R[Rt[x]]=at(3),tt(3);for(null;x<19;x++)R[Rt[x]]=0;if(h=7,w=new $t(R,19,19,null,null,h),w.status!==0)return-1;for(H=w.root,h=w.m,Nt=et+N,d=C=0;d<Nt;)if(P(h),ut=H.list[at(h)],x=ut.b,tt(x),x=ut.n,x<16)R[d++]=C=x;else if(x===16){if(P(2),x=3+at(2),tt(2),d+x>Nt)return-1;for(;x-- >0;)R[d++]=C}else if(x===17){if(P(3),x=3+at(3),tt(3),d+x>Nt)return-1;for(;x-- >0;)R[d++]=0;C=0}else{if(P(7),x=11+at(7),tt(7),d+x>Nt)return-1;for(;x-- >0;)R[d++]=0;C=0}if(h=s,w=new $t(R,et,257,ct,dt,h),h===0&&(w.status=1),w.status!==0&&w.status!==1)return-1;for(H=w.root,h=w.m,d=0;d<N;d++)R[d]=R[d+et];return g=o,w=new $t(R,N,0,It,Tt,g),V=w.root,g=w.m,g===0&&et>257||w.status!==0?-1:jt(D,L,M)}function Z(){n||(n=[]),l=0,m=0,v=0,O=-1,U=!1,_=J=0,H=null}function we(D,L,M){var d,x;for(d=0;d<M;){if(U&&O===-1)return d;if(_>0){if(O!==t)for(;_>0&&d<M;)_--,J&=e-1,l&=e-1,D[L+d++]=n[l++]=n[J++];else{for(;_>0&&d<M;)_--,l&=e-1,P(8),D[L+d++]=n[l++]=at(8),tt(8);_===0&&(O=-1)}if(d===M)return d}if(O===-1){if(U)break;P(1),at(1)!==0&&(U=!0),tt(1),P(2),O=at(2),tt(2),H=null,_=0}switch(O){case t:x=xt(D,L+d,M-d);break;case r:H?x=jt(D,L+d,M-d):x=pt(D,L+d,M-d);break;case i:H?x=jt(D,L+d,M-d):x=de(D,L+d,M-d);break;default:x=-1;break}if(x===-1)return U?0:-1;d+=x}return d}function ke(D){var L=[],M;Z(),B=D,q=0;do M=we(L,L.length,1024);while(M>0);return B=null,L}Mn.exports=ke})();var va=Mn.exports,Yr={exports:{}};(function(){var e=32768,t=0,r=1,i=2,s=6,o=1024*8,n=2*e,l=3,u=258,f=8192,S=15,k=f,m=1<<S,v=m-1,O=e-1,U=0,_=4096,J=u+l+1,H=e-J,V=1,h=15,g=7,B=29,q=256,G=256,ct=q+1+B,dt=30,It=19,Tt=16,Rt=17,xe=18,he=2*ct+1,$t=parseInt((S+l-1)/l,10),Zt,P,at,tt,jt=null,xt,pt,de,Z,we,ke,D,L,M,d,x,C,Nt,ut,z,et,N,R,w,I,Ct,Ft,ft,yt,Mt,X,wt,At,st,rt,vt,mt,bt,lt,Y,Qt,pe,qt,_e,Ie,Or,Re,je,te,He,Br,Te,Ve,me,qe,Je,Ur;function Se(){this.fc=0,this.dl=0}function Er(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function Gt(a,c,y,p){this.good_length=a,this.max_lazy=c,this.nice_length=y,this.max_chain=p}function An(){this.next=null,this.len=0,this.ptr=[],this.off=0}var Nr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Oe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Pn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Kr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],We=[new Gt(0,0,0,0),new Gt(4,4,8,4),new Gt(4,5,16,8),new Gt(4,6,32,32),new Gt(4,4,16,16),new Gt(8,16,32,32),new Gt(8,16,128,128),new Gt(8,32,128,256),new Gt(32,128,258,1024),new Gt(32,258,258,4096)];function Dn(a){var c;if(a?a<1?a=1:a>9&&(a=9):a=s,ft=a,tt=!1,w=!1,jt===null){for(Zt=P=at=null,jt=[],Z=[],we=[],ke=[],D=[],X=[],c=0;c<he;c++)X[c]=new Se;for(wt=[],c=0;c<2*dt+1;c++)wt[c]=new Se;for(At=[],c=0;c<ct+2;c++)At[c]=new Se;for(st=[],c=0;c<dt;c++)st[c]=new Se;for(rt=[],c=0;c<2*It+1;c++)rt[c]=new Se;vt=new Er,mt=new Er,bt=new Er,lt=[],Y=[],qt=[],_e=[],Ie=[],Or=[],Re=[],je=[]}}function Ln(a){a.next=Zt,Zt=a}function Rn(){var a;return Zt!==null?(a=Zt,Zt=Zt.next):a=new An,a.next=null,a.len=a.off=0,a}function $r(a){return D[e+a]}function Zr(a,c){return D[e+a]=c}function Ge(a){jt[pt+xt++]=a,pt+xt===o&&Xn()}function ze(a){a&=65535,pt+xt<o-2?(jt[pt+xt++]=a&255,jt[pt+xt++]=a>>>8):(Ge(a&255),Ge(a>>>8))}function Ye(){x=(x<<$t^Z[N+l-1]&255)&v,C=$r(x),D[N&O]=C,Zr(x,N)}function ee(a,c){Pt(c[a].fc,c[a].dl)}function Qr(a){return(a<256?Ie[a]:Ie[256+(a>>7)])&255}function tn(a,c,y){return a[c].fc<a[y].fc||a[c].fc===a[y].fc&&qt[c]<=qt[y]}function en(a,c,y){var p;for(p=0;p<y&&Ur<Je.length;p++)a[c+p]=Je[Ur++]&255;return p}function jn(){var a;for(a=0;a<m;a++)D[e+a]=0;if(Ft=We[ft].max_lazy,yt=We[ft].good_length,Mt=We[ft].nice_length,Ct=We[ft].max_chain,N=0,d=0,I=en(Z,0,2*e),I<=0){w=!0,I=0;return}for(w=!1;I<J&&!w;)Cr();for(x=0,a=0;a<l-1;a++)x=(x<<$t^Z[a]&255)&v}function rn(a){var c=Ct,y=N,p,b,T=et,j=N>H?N-H:U,W=N+u,A=Z[y+T-1],kt=Z[y+T],Q,ne;et>=yt&&(c>>=2);do if(p=a,!(Z[p+T]!==kt||Z[p+T-1]!==A||Z[p]!==Z[y]||Z[++p]!==Z[y+1])){for(y+=2,p++;y<W;){for(ne=!1,Q=0;Q<8;Q+=1)if(y+=1,p+=1,Z[y]!==Z[p]){ne=!0;break}if(ne)break}if(b=u-(W-y),y=W-u,b>T){if(R=a,T=b,b>=Mt)break;A=Z[y+T-1],kt=Z[y+T]}}while((a=D[a&O])>j&&--c!==0);return T}function Cr(){var a,c,y=n-I-N;if(y===-1)y--;else if(N>=e+H){for(a=0;a<e;a++)Z[a]=Z[a+e];for(R-=e,N-=e,d-=e,a=0;a<m;a++)c=$r(a),Zr(a,c>=e?c-e:U);for(a=0;a<e;a++)c=D[a],D[a]=c>=e?c-e:U;y+=e}w||(a=en(Z,N+I,y),a<=0?w=!0:I+=a)}function Hn(){for(;I!==0&&P===null;){var a;if(Ye(),C!==U&&N-C<=H&&(z=rn(C),z>I&&(z=I)),z>=l)if(a=Be(N-R,z-l),I-=z,z<=Ft){z--;do N++,Ye();while(--z!==0);N++}else N+=z,z=0,x=Z[N]&255,x=(x<<$t^Z[N+1]&255)&v;else a=Be(0,Z[N]&255),I--,N++;for(a&&(Xe(0),d=N);I<J&&!w;)Cr()}}function Vn(){for(;I!==0&&P===null;){if(Ye(),et=z,Nt=R,z=l-1,C!==U&&et<Ft&&N-C<=H&&(z=rn(C),z>I&&(z=I),z===l&&N-R>_&&z--),et>=l&&z<=et){var a;a=Be(N-1-Nt,et-l),I-=et-1,et-=2;do N++,Ye();while(--et!==0);ut=!1,z=l-1,N++,a&&(Xe(0),d=N)}else ut?(Be(0,Z[N-1]&255)&&(Xe(0),d=N),N++,I--):(ut=!0,N++,I--);for(;I<J&&!w;)Cr()}}function qn(){w||(L=0,M=0,Wn(),jn(),P=null,xt=0,pt=0,ft<=3?(et=l-1,z=0):(z=l-1,ut=!1),de=!1)}function Jn(a,c,y){var p;return!tt&&(qn(),tt=!0,I===0)?(de=!0,0):(p=nn(a,c,y),p===y?y:de?p:(ft<=3?Hn():Vn(),I===0&&(ut&&Be(0,Z[N-1]&255),Xe(1),de=!0),p+nn(a,p+c,y-p)))}function nn(a,c,y){var p,b,T;for(p=0;P!==null&&p<y;){for(b=y-p,b>P.len&&(b=P.len),T=0;T<b;T++)a[c+p+T]=P.ptr[P.off+T];if(P.off+=b,P.len-=b,p+=b,P.len===0){var j;j=P,P=P.next,Ln(j)}}if(p===y)return p;if(pt<xt){for(b=y-p,b>xt-pt&&(b=xt-pt),T=0;T<b;T++)a[c+p+T]=jt[pt+T];pt+=b,p+=b,xt===pt&&(xt=pt=0)}return p}function Wn(){var a,c,y,p,b;if(st[0].dl===0){for(vt.dyn_tree=X,vt.static_tree=At,vt.extra_bits=Nr,vt.extra_base=q+1,vt.elems=ct,vt.max_length=h,vt.max_code=0,mt.dyn_tree=wt,mt.static_tree=st,mt.extra_bits=Oe,mt.extra_base=0,mt.elems=dt,mt.max_length=h,mt.max_code=0,bt.dyn_tree=rt,bt.static_tree=null,bt.extra_bits=Pn,bt.extra_base=0,bt.elems=It,bt.max_length=g,bt.max_code=0,y=0,p=0;p<B-1;p++)for(Or[p]=y,a=0;a<1<<Nr[p];a++)_e[y++]=p;for(_e[y-1]=p,b=0,p=0;p<16;p++)for(Re[p]=b,a=0;a<1<<Oe[p];a++)Ie[b++]=p;for(b>>=7;p<dt;p++)for(Re[p]=b<<7,a=0;a<1<<Oe[p]-7;a++)Ie[256+b++]=p;for(c=0;c<=h;c++)lt[c]=0;for(a=0;a<=143;)At[a++].dl=8,lt[8]++;for(;a<=255;)At[a++].dl=9,lt[9]++;for(;a<=279;)At[a++].dl=7,lt[7]++;for(;a<=287;)At[a++].dl=8,lt[8]++;for(sn(At,ct+1),a=0;a<dt;a++)st[a].dl=5,st[a].fc=fn(a,5);an()}}function an(){var a;for(a=0;a<ct;a++)X[a].fc=0;for(a=0;a<dt;a++)wt[a].fc=0;for(a=0;a<It;a++)rt[a].fc=0;X[G].fc=1,me=qe=0,te=He=Br=0,Te=0,Ve=1}function Fr(a,c){for(var y=Y[c],p=c<<1;p<=Qt&&(p<Qt&&tn(a,Y[p+1],Y[p])&&p++,!tn(a,y,Y[p]));)Y[c]=Y[p],c=p,p<<=1;Y[c]=y}function Gn(a){var c=a.dyn_tree,y=a.extra_bits,p=a.extra_base,b=a.max_code,T=a.max_length,j=a.static_tree,W,A,kt,Q,ne,Pr,Ke=0;for(Q=0;Q<=h;Q++)lt[Q]=0;for(c[Y[pe]].dl=0,W=pe+1;W<he;W++)A=Y[W],Q=c[c[A].dl].dl+1,Q>T&&(Q=T,Ke++),c[A].dl=Q,!(A>b)&&(lt[Q]++,ne=0,A>=p&&(ne=y[A-p]),Pr=c[A].fc,me+=Pr*(Q+ne),j!==null&&(qe+=Pr*(j[A].dl+ne)));if(Ke!==0){do{for(Q=T-1;lt[Q]===0;)Q--;lt[Q]--,lt[Q+1]+=2,lt[T]--,Ke-=2}while(Ke>0);for(Q=T;Q!==0;Q--)for(A=lt[Q];A!==0;)kt=Y[--W],!(kt>b)&&(c[kt].dl!==Q&&(me+=(Q-c[kt].dl)*c[kt].fc,c[kt].fc=Q),A--)}}function sn(a,c){var y=[],p=0,b,T;for(b=1;b<=h;b++)p=p+lt[b-1]<<1,y[b]=p;for(T=0;T<=c;T++){var j=a[T].dl;j!==0&&(a[T].fc=fn(y[j]++,j))}}function Mr(a){var c=a.dyn_tree,y=a.static_tree,p=a.elems,b,T,j=-1,W=p;for(Qt=0,pe=he,b=0;b<p;b++)c[b].fc!==0?(Y[++Qt]=j=b,qt[b]=0):c[b].dl=0;for(;Qt<2;){var A=Y[++Qt]=j<2?++j:0;c[A].fc=1,qt[A]=0,me--,y!==null&&(qe-=y[A].dl)}for(a.max_code=j,b=Qt>>1;b>=1;b--)Fr(c,b);do b=Y[V],Y[V]=Y[Qt--],Fr(c,V),T=Y[V],Y[--pe]=b,Y[--pe]=T,c[W].fc=c[b].fc+c[T].fc,qt[b]>qt[T]+1?qt[W]=qt[b]:qt[W]=qt[T]+1,c[b].dl=c[T].dl=W,Y[V]=W++,Fr(c,V);while(Qt>=2);Y[--pe]=Y[V],Gn(a),sn(c,j)}function on(a,c){var y,p=-1,b,T=a[0].dl,j=0,W=7,A=4;for(T===0&&(W=138,A=3),a[c+1].dl=65535,y=0;y<=c;y++)b=T,T=a[y+1].dl,!(++j<W&&b===T)&&(j<A?rt[b].fc+=j:b!==0?(b!==p&&rt[b].fc++,rt[Tt].fc++):j<=10?rt[Rt].fc++:rt[xe].fc++,j=0,p=b,T===0?(W=138,A=3):b===T?(W=6,A=3):(W=7,A=4))}function cn(a,c){var y,p=-1,b,T=a[0].dl,j=0,W=7,A=4;for(T===0&&(W=138,A=3),y=0;y<=c;y++)if(b=T,T=a[y+1].dl,!(++j<W&&b===T)){if(j<A)do ee(b,rt);while(--j!==0);else b!==0?(b!==p&&(ee(b,rt),j--),ee(Tt,rt),Pt(j-3,2)):j<=10?(ee(Rt,rt),Pt(j-3,3)):(ee(xe,rt),Pt(j-11,7));j=0,p=b,T===0?(W=138,A=3):b===T?(W=6,A=3):(W=7,A=4)}}function zn(){var a;for(on(X,vt.max_code),on(wt,mt.max_code),Mr(bt),a=It-1;a>=3&&rt[Kr[a]].dl===0;a--);return me+=3*(a+1)+5+5+4,a}function Yn(a,c,y){var p;for(Pt(a-257,5),Pt(c-1,5),Pt(y-4,4),p=0;p<y;p++)Pt(rt[Kr[p]].dl,3);cn(X,a-1),cn(wt,c-1)}function Xe(a){var c,y,p,b,T;if(b=N-d,je[Br]=Te,Mr(vt),Mr(mt),p=zn(),c=me+3+7>>3,y=qe+3+7>>3,y<=c&&(c=y),b+4<=c&&d>=0)for(Pt((t<<1)+a,3),ln(),ze(b),ze(~b),T=0;T<b;T++)Ge(Z[d+T]);else y===c?(Pt((r<<1)+a,3),un(At,st)):(Pt((i<<1)+a,3),Yn(vt.max_code+1,mt.max_code+1,p+1),un(X,wt));an(),a!==0&&ln()}function Be(a,c){if(ke[te++]=c,a===0?X[c].fc++:(a--,X[_e[c]+q+1].fc++,wt[Qr(a)].fc++,we[He++]=a,Te|=Ve),Ve<<=1,te&7||(je[Br++]=Te,Te=0,Ve=1),ft>2&&!(te&4095)){var y=te*8,p=N-d,b;for(b=0;b<dt;b++)y+=wt[b].fc*(5+Oe[b]);if(y>>=3,He<parseInt(te/2,10)&&y<parseInt(p/2,10))return!0}return te===f-1||He===k}function un(a,c){var y,p,b=0,T=0,j=0,W=0,A,kt;if(te!==0)do b&7||(W=je[j++]),p=ke[b++]&255,W&1?(A=_e[p],ee(A+q+1,a),kt=Nr[A],kt!==0&&(p-=Or[A],Pt(p,kt)),y=we[T++],A=Qr(y),ee(A,c),kt=Oe[A],kt!==0&&(y-=Re[A],Pt(y,kt))):ee(p,a),W>>=1;while(b<te);ee(G,a)}var Ar=16;function Pt(a,c){M>Ar-c?(L|=a<<M,ze(L),L=a>>Ar-M,M+=c-Ar):(L|=a<<M,M+=c)}function fn(a,c){var y=0;do y|=a&1,a>>=1,y<<=1;while(--c>0);return y>>1}function ln(){M>8?ze(L):M>0&&Ge(L),L=0,M=0}function Xn(){var a,c;if(xt!==0){for(a=Rn(),P===null?P=at=a:at=at.next=a,a.len=xt-pt,c=0;c<a.len;c++)a.ptr[c]=jt[pt+c];xt=pt=0}}function Kn(a,c){var y,p;Je=a,Ur=0,typeof c>"u"&&(c=s),Dn(c),p=[];do y=Jn(p,p.length,1024);while(y>0);return Je=null,p}Yr.exports=Kn,Yr.exports.DEFAULT_LEVEL=s})();var ga=Yr.exports;(function(){Fn.exports={inflate:va,deflate:ga}})();var xa=Fn.exports;(function(){var e=ya,t=xa,r=31,i=139,s={deflate:8},o={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},n={fat:0,amiga:1,vmz:2,unix:3,"vm/cms":4,atari:5,hpfs:6,macintosh:7,"z-system":8,cplm:9,"tops-20":10,ntfs:11,qdos:12,acorn:13,vfat:14,vms:15,beos:16,tandem:17,theos:18},l="unix",u=6;function f(h,g){g.push(h&255)}function S(h,g){g.push(h&255),g.push(h>>>8)}function k(h,g){S(h&65535,g),S(h>>>16,g)}function m(h,g){var B,q=h.length;for(B=0;B<q;B+=1)f(h.charCodeAt(B),g)}function v(h){return h.shift()}function O(h){return h.shift()|h.shift()<<8}function U(h){var g=O(h),B=O(h);return B>32768?(B-=32768,(B<<16|g)+32768*Math.pow(2,16)):B<<16|g}function _(h){for(var g=[];h[0]!==0;)g.push(String.fromCharCode(h.shift()));return h.shift(),g.join("")}function J(h,g){var B,q=[];for(B=0;B<g;B+=1)q.push(h.shift());return q}function H(h,g){var B=0,q,G=[];return g||(g={}),q=g.level||u,typeof h=="string"&&(h=Array.prototype.map.call(h,function(ct){return ct.charCodeAt(0)})),f(r,G),f(i,G),f(s.deflate,G),g.name&&(B|=o.FNAME),f(B,G),k(g.timestamp||parseInt(Date.now()/1e3,10),G),f(q===1?4:q===9?2:0,G),f(n[l],G),g.name&&(m(g.name.substring(g.name.lastIndexOf("/")+1),G),f(0,G)),t.deflate(h,q).forEach(function(ct){f(ct,G)}),k(parseInt(e(h),16),G),k(h.length,G),G}function V(h,g){var B=Array.prototype.slice.call(h,0),q,G,ct,dt,It,Tt;if(v(B)!==r||v(B)!==i)throw"Not a GZIP file";if(q=v(B),q=Object.keys(s).some(function(Rt){return G=Rt,s[Rt]===q}),!q)throw"Unsupported compression method";if(ct=v(B),U(B),v(B),q=v(B),Object.keys(n).some(function(Rt){if(n[Rt]===q)return!0}),ct&o.FEXTRA&&(q=O(B),J(B,q)),ct&o.FNAME&&_(B),ct&o.FCOMMENT&&_(B),ct&o.FHCRC&&O(B),G==="deflate"&&(Tt=t.inflate(B.splice(0,B.length-8))),ct&o.FTEXT&&(Tt=Array.prototype.map.call(Tt,function(Rt){return String.fromCharCode(Rt)}).join("")),dt=U(B),dt!==parseInt(e(Tt),16))throw"Checksum does not match";if(It=U(B),It!==Tt.length)throw"Size of decompressed file not correct";return Tt}Cn.exports={zip:H,unzip:V,get DEFAULT_LEVEL(){return u}}})();var wa=Cn.exports;const ka=ai(wa),{document:mn}=ni;function _a(e){let t=e[1].name+"",r;return{c(){r=gr(t)},l(i){r=xr(i,t)},m(i,s){Fe(i,r,s)},p(i,s){s&2&&t!==(t=i[1].name+"")&&ii(r,t)},d(i){i&&Ut(r)}}}function Ia(e){let t;return{c(){t=gr("Upload a file")},l(r){t=xr(r,"Upload a file")},m(r,i){Fe(r,t,i)},p:Hr,d(r){r&&Ut(t)}}}function bn(e){let t,r,i,s,o,n;return{c(){t=Yt("div"),r=Yt("button"),i=gr("Create"),this.h()},l(l){t=Xt(l,"DIV",{class:!0});var u=se(t);r=Xt(u,"BUTTON",{class:!0});var f=se(r);i=xr(f,"Create"),f.forEach(Ut),u.forEach(Ut),this.h()},h(){Vt(r,"class","px-4 py-2 bg-perlwinkle rounded text-2xl shadow-bistre shadow-sm"),r.disabled=s=!e[1],Vt(t,"class","text-center")},m(l,u){Fe(l,t,u),Ot(t,r),Ot(r,i),o||(n=yn(r,"click",e[2]),o=!0)},p(l,u){u&2&&s!==(s=!l[1])&&(r.disabled=s)},d(l){l&&Ut(t),o=!1,n()}}}function Ta(e){let t,r,i,s,o,n,l,u,f,S,k,m,v,O,U,_;function J(g,B){return g[1]===void 0?Ia:_a}let H=J(e),V=H(e),h=e[1]!==void 0&&bn(e);return{c(){t=Ue(),r=Yt("div"),i=Yt("div"),s=Yt("h1"),o=gr("Create Schematic File"),n=Ue(),l=Yt("br"),u=Ue(),f=Yt("div"),S=Yt("label"),k=Yt("div"),V.c(),m=Ue(),v=Yt("input"),O=Ue(),h&&h.c(),this.h()},l(g){ri("svelte-ylt5v9",mn.head).forEach(Ut),t=Ee(g),r=Xt(g,"DIV",{class:!0});var q=se(r);i=Xt(q,"DIV",{class:!0});var G=se(i);s=Xt(G,"H1",{class:!0});var ct=se(s);o=xr(ct,"Create Schematic File"),ct.forEach(Ut),n=Ee(G),l=Xt(G,"BR",{}),u=Ee(G),f=Xt(G,"DIV",{class:!0});var dt=se(f);S=Xt(dt,"LABEL",{for:!0,class:!0});var It=se(S);k=Xt(It,"DIV",{class:!0});var Tt=se(k);V.l(Tt),Tt.forEach(Ut),m=Ee(It),v=Xt(It,"INPUT",{id:!0,type:!0,accept:!0}),It.forEach(Ut),O=Ee(dt),h&&h.l(dt),dt.forEach(Ut),G.forEach(Ut),q.forEach(Ut),this.h()},h(){mn.title="MidiMC | Create",Vt(s,"class","text-4xl"),Vt(k,"class","text-4xl"),Vt(v,"id","file"),Vt(v,"type","file"),Vt(v,"accept",".mid,.midi"),v.hidden=!0,Vt(S,"for","file"),Vt(S,"class","inline-block border-dashed border-2 border-bistre cursor-pointer p-2 text-center bg-tea"),Vt(f,"class","grid content-center space-y-8"),Vt(i,"class","my-8"),Vt(r,"class","mx-auto container")},m(g,B){Fe(g,t,B),Fe(g,r,B),Ot(r,i),Ot(i,s),Ot(s,o),Ot(i,n),Ot(i,l),Ot(i,u),Ot(i,f),Ot(f,S),Ot(S,k),V.m(k,null),Ot(S,m),Ot(S,v),Ot(f,O),h&&h.m(f,null),U||(_=yn(v,"change",e[3]),U=!0)},p(g,[B]){H===(H=J(g))&&V?V.p(g,B):(V.d(1),V=H(g),V&&(V.c(),V.m(k,null))),g[1]!==void 0?h?h.p(g,B):(h=bn(g),h.c(),h.m(f,null)):h&&(h.d(1),h=null)},i:Hr,o:Hr,d(g){g&&Ut(t),g&&Ut(r),V.d(),h&&h.d(),U=!1,_()}}}function Sa(e,t,r){let i,s;const o=(u,f)=>{const S=new Blob([u]),k=document.createElement("a"),m=URL.createObjectURL(S);k.href=m,k.download=f,document.body.appendChild(k),k.click(),setTimeout(function(){document.body.removeChild(k),window.URL.revokeObjectURL(m)},0)},n=async()=>{if(!i){console.log("No file was selected");return}const u=i.name.split(".")[0],f=await i.arrayBuffer(),S=ba(new ir.Midi(f)),k=ma(S),m=await Ki(k);o(new Uint8Array(ka.zip(m)),`${u}.schem`)};function l(){s=this.files,r(0,s)}return e.$$.update=()=>{e.$$.dirty&1&&r(1,i=s&&s[0])},[s,i,n,l]}class Ua extends Qn{constructor(t){super(),ti(this,t,Sa,Ta,ei,{})}}export{Ua as default};
