var Gn=Object.defineProperty;var Wn=(t,e,r)=>e in t?Gn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Je=(t,e,r)=>(Wn(t,typeof e!="symbol"?e+"":e,r),r),Cr=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var E=(t,e,r)=>(Cr(t,e,"read from private field"),r?r.call(t):e.get(t)),ae=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},ve=(t,e,r,i)=>(Cr(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r);var F=(t,e,r)=>(Cr(t,e,"access private method"),r);import{S as zn,i as Yn,s as Xn,a as Tt,k as Ge,q as pr,J as Kn,h as Be,c as St,l as We,m as nt,r as mr,n as je,b as Et,C as Te,R as pn,D as Ar,T as $n,u as Zn}from"../chunks/index.a46bc94f.js";var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qn(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){if(this instanceof i){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(e,s);return new o}return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}),r}var Ot={},br={};function ei(t){var e=new Ie(t),r=e.readChunk();if(r.id!="MThd")throw"Bad MIDI file.  Expected 'MHdr', got: '"+r.id+"'";for(var i=ti(r.data),s=[],o=0;!e.eof()&&o<i.numTracks;o++){var n=e.readChunk();if(n.id!="MTrk")throw"Bad MIDI file.  Expected 'MTrk', got: '"+n.id+"'";var l=ri(n.data);s.push(l)}return{header:i,tracks:s}}function ti(t){var e=new Ie(t),r=e.readUInt16(),i=e.readUInt16(),s={format:r,numTracks:i},o=e.readUInt16();return o&32768?(s.framesPerSecond=256-(o>>8),s.ticksPerFrame=o&255):s.ticksPerBeat=o,s}function ri(t){for(var e=new Ie(t),r=[];!e.eof();){var i=o();r.push(i)}return r;var s;function o(){var n={};n.deltaTime=e.readVarInt();var l=e.readUInt8();if((l&240)===240)if(l===255){n.meta=!0;var f=e.readUInt8(),u=e.readVarInt();switch(f){case 0:if(n.type="sequenceNumber",u!==2)throw"Expected length for sequenceNumber event is 2, got "+u;return n.number=e.readUInt16(),n;case 1:return n.type="text",n.text=e.readString(u),n;case 2:return n.type="copyrightNotice",n.text=e.readString(u),n;case 3:return n.type="trackName",n.text=e.readString(u),n;case 4:return n.type="instrumentName",n.text=e.readString(u),n;case 5:return n.type="lyrics",n.text=e.readString(u),n;case 6:return n.type="marker",n.text=e.readString(u),n;case 7:return n.type="cuePoint",n.text=e.readString(u),n;case 32:if(n.type="channelPrefix",u!=1)throw"Expected length for channelPrefix event is 1, got "+u;return n.channel=e.readUInt8(),n;case 33:if(n.type="portPrefix",u!=1)throw"Expected length for portPrefix event is 1, got "+u;return n.port=e.readUInt8(),n;case 47:if(n.type="endOfTrack",u!=0)throw"Expected length for endOfTrack event is 0, got "+u;return n;case 81:if(n.type="setTempo",u!=3)throw"Expected length for setTempo event is 3, got "+u;return n.microsecondsPerBeat=e.readUInt24(),n;case 84:if(n.type="smpteOffset",u!=5)throw"Expected length for smpteOffset event is 5, got "+u;var S=e.readUInt8(),_={0:24,32:25,64:29,96:30};return n.frameRate=_[S&96],n.hour=S&31,n.min=e.readUInt8(),n.sec=e.readUInt8(),n.frame=e.readUInt8(),n.subFrame=e.readUInt8(),n;case 88:if(n.type="timeSignature",u!=2&&u!=4)throw"Expected length for timeSignature event is 4 or 2, got "+u;return n.numerator=e.readUInt8(),n.denominator=1<<e.readUInt8(),u===4?(n.metronome=e.readUInt8(),n.thirtyseconds=e.readUInt8()):(n.metronome=36,n.thirtyseconds=8),n;case 89:if(n.type="keySignature",u!=2)throw"Expected length for keySignature event is 2, got "+u;return n.key=e.readInt8(),n.scale=e.readUInt8(),n;case 127:return n.type="sequencerSpecific",n.data=e.readBytes(u),n;default:return n.type="unknownMeta",n.data=e.readBytes(u),n.metatypeByte=f,n}}else if(l==240){n.type="sysEx";var u=e.readVarInt();return n.data=e.readBytes(u),n}else if(l==247){n.type="endSysEx";var u=e.readVarInt();return n.data=e.readBytes(u),n}else throw"Unrecognised MIDI event type byte: "+l;else{var m;if(l&128)m=e.readUInt8(),s=l;else{if(s===null)throw"Running status byte encountered before status byte";m=l,l=s,n.running=!0}var v=l>>4;switch(n.channel=l&15,v){case 8:return n.type="noteOff",n.noteNumber=m,n.velocity=e.readUInt8(),n;case 9:var B=e.readUInt8();return n.type=B===0?"noteOff":"noteOn",n.noteNumber=m,n.velocity=B,B===0&&(n.byte9=!0),n;case 10:return n.type="noteAftertouch",n.noteNumber=m,n.amount=e.readUInt8(),n;case 11:return n.type="controller",n.controllerType=m,n.value=e.readUInt8(),n;case 12:return n.type="programChange",n.programNumber=m,n;case 13:return n.type="channelAftertouch",n.amount=m,n;case 14:return n.type="pitchBend",n.value=m+(e.readUInt8()<<7)-8192,n;default:throw"Unrecognised MIDI event type: "+v}}}}function Ie(t){this.buffer=t,this.bufferLen=this.buffer.length,this.pos=0}Ie.prototype.eof=function(){return this.pos>=this.bufferLen};Ie.prototype.readUInt8=function(){var t=this.buffer[this.pos];return this.pos+=1,t};Ie.prototype.readInt8=function(){var t=this.readUInt8();return t&128?t-256:t};Ie.prototype.readUInt16=function(){var t=this.readUInt8(),e=this.readUInt8();return(t<<8)+e};Ie.prototype.readInt16=function(){var t=this.readUInt16();return t&32768?t-65536:t};Ie.prototype.readUInt24=function(){var t=this.readUInt8(),e=this.readUInt8(),r=this.readUInt8();return(t<<16)+(e<<8)+r};Ie.prototype.readInt24=function(){var t=this.readUInt24();return t&8388608?t-16777216:t};Ie.prototype.readUInt32=function(){var t=this.readUInt8(),e=this.readUInt8(),r=this.readUInt8(),i=this.readUInt8();return(t<<24)+(e<<16)+(r<<8)+i};Ie.prototype.readBytes=function(t){var e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e};Ie.prototype.readString=function(t){var e=this.readBytes(t);return String.fromCharCode.apply(null,e)};Ie.prototype.readVarInt=function(){for(var t=0;!this.eof();){var e=this.readUInt8();if(e&128)t+=e&127,t<<=7;else return t+e}return t};Ie.prototype.readChunk=function(){var t=this.readString(4),e=this.readUInt32(),r=this.readBytes(e);return{id:t,length:e,data:r}};var ni=ei;function ii(t,e){if(typeof t!="object")throw"Invalid MIDI data";e=e||{};var r=t.header||{},i=t.tracks||[],s,o=i.length,n=new le;for(ai(n,r,o),s=0;s<o;s++)si(n,i[s],e);return n.buffer}function ai(t,e,r){var i=e.format==null?1:e.format,s=128;e.timeDivision?s=e.timeDivision:e.ticksPerFrame&&e.framesPerSecond?s=-(e.framesPerSecond&255)<<8|e.ticksPerFrame&255:e.ticksPerBeat&&(s=e.ticksPerBeat&32767);var o=new le;o.writeUInt16(i),o.writeUInt16(r),o.writeUInt16(s),t.writeChunk("MThd",o.buffer)}function si(t,e,r){var i=new le,s,o=e.length,n=null;for(s=0;s<o;s++)(r.running===!1||!r.running&&!e[s].running)&&(n=null),n=oi(i,e[s],n,r.useByte9ForNoteOff);t.writeChunk("MTrk",i.buffer)}function oi(t,e,r,i){var s=e.type,o=e.deltaTime,n=e.text||"",l=e.data||[],f=null;switch(t.writeVarInt(o),s){case"sequenceNumber":t.writeUInt8(255),t.writeUInt8(0),t.writeVarInt(2),t.writeUInt16(e.number);break;case"text":t.writeUInt8(255),t.writeUInt8(1),t.writeVarInt(n.length),t.writeString(n);break;case"copyrightNotice":t.writeUInt8(255),t.writeUInt8(2),t.writeVarInt(n.length),t.writeString(n);break;case"trackName":t.writeUInt8(255),t.writeUInt8(3),t.writeVarInt(n.length),t.writeString(n);break;case"instrumentName":t.writeUInt8(255),t.writeUInt8(4),t.writeVarInt(n.length),t.writeString(n);break;case"lyrics":t.writeUInt8(255),t.writeUInt8(5),t.writeVarInt(n.length),t.writeString(n);break;case"marker":t.writeUInt8(255),t.writeUInt8(6),t.writeVarInt(n.length),t.writeString(n);break;case"cuePoint":t.writeUInt8(255),t.writeUInt8(7),t.writeVarInt(n.length),t.writeString(n);break;case"channelPrefix":t.writeUInt8(255),t.writeUInt8(32),t.writeVarInt(1),t.writeUInt8(e.channel);break;case"portPrefix":t.writeUInt8(255),t.writeUInt8(33),t.writeVarInt(1),t.writeUInt8(e.port);break;case"endOfTrack":t.writeUInt8(255),t.writeUInt8(47),t.writeVarInt(0);break;case"setTempo":t.writeUInt8(255),t.writeUInt8(81),t.writeVarInt(3),t.writeUInt24(e.microsecondsPerBeat);break;case"smpteOffset":t.writeUInt8(255),t.writeUInt8(84),t.writeVarInt(5);var u={24:0,25:32,29:64,30:96},S=e.hour&31|u[e.frameRate];t.writeUInt8(S),t.writeUInt8(e.min),t.writeUInt8(e.sec),t.writeUInt8(e.frame),t.writeUInt8(e.subFrame);break;case"timeSignature":t.writeUInt8(255),t.writeUInt8(88),t.writeVarInt(4),t.writeUInt8(e.numerator);var _=Math.floor(Math.log(e.denominator)/Math.LN2)&255;t.writeUInt8(_),t.writeUInt8(e.metronome),t.writeUInt8(e.thirtyseconds||8);break;case"keySignature":t.writeUInt8(255),t.writeUInt8(89),t.writeVarInt(2),t.writeInt8(e.key),t.writeUInt8(e.scale);break;case"sequencerSpecific":t.writeUInt8(255),t.writeUInt8(127),t.writeVarInt(l.length),t.writeBytes(l);break;case"unknownMeta":e.metatypeByte!=null&&(t.writeUInt8(255),t.writeUInt8(e.metatypeByte),t.writeVarInt(l.length),t.writeBytes(l));break;case"sysEx":t.writeUInt8(240),t.writeVarInt(l.length),t.writeBytes(l);break;case"endSysEx":t.writeUInt8(247),t.writeVarInt(l.length),t.writeBytes(l);break;case"noteOff":var m=i!==!1&&e.byte9||i&&e.velocity==0?144:128;f=m|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteOn":f=144|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.noteNumber),t.writeUInt8(e.velocity);break;case"noteAftertouch":f=160|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.noteNumber),t.writeUInt8(e.amount);break;case"controller":f=176|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.controllerType),t.writeUInt8(e.value);break;case"programChange":f=192|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.programNumber);break;case"channelAftertouch":f=208|e.channel,f!==r&&t.writeUInt8(f),t.writeUInt8(e.amount);break;case"pitchBend":f=224|e.channel,f!==r&&t.writeUInt8(f);var v=8192+e.value,B=v&127,O=v>>7&127;t.writeUInt8(B),t.writeUInt8(O);break;default:throw"Unrecognized event type: "+s}return f}function le(){this.buffer=[]}le.prototype.writeUInt8=function(t){this.buffer.push(t&255)};le.prototype.writeInt8=le.prototype.writeUInt8;le.prototype.writeUInt16=function(t){var e=t>>8&255,r=t&255;this.writeUInt8(e),this.writeUInt8(r)};le.prototype.writeInt16=le.prototype.writeUInt16;le.prototype.writeUInt24=function(t){var e=t>>16&255,r=t>>8&255,i=t&255;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(i)};le.prototype.writeInt24=le.prototype.writeUInt24;le.prototype.writeUInt32=function(t){var e=t>>24&255,r=t>>16&255,i=t>>8&255,s=t&255;this.writeUInt8(e),this.writeUInt8(r),this.writeUInt8(i),this.writeUInt8(s)};le.prototype.writeInt32=le.prototype.writeUInt32;le.prototype.writeBytes=function(t){this.buffer=this.buffer.concat(Array.prototype.slice.call(t,0))};le.prototype.writeString=function(t){var e,r=t.length,i=[];for(e=0;e<r;e++)i.push(t.codePointAt(e));this.writeBytes(i)};le.prototype.writeVarInt=function(t){if(t<0)throw"Cannot write negative variable-length integer";if(t<=127)this.writeUInt8(t);else{var e=t,r=[];for(r.push(e&127),e>>=7;e;){var i=e&127|128;r.push(i),e>>=7}this.writeBytes(r.reverse())}};le.prototype.writeChunk=function(t,e){this.writeString(t),this.writeUInt32(e.length),this.writeBytes(e)};var ci=ii;br.parseMidi=ni;br.writeMidi=ci;var tr={},ct={};Object.defineProperty(ct,"__esModule",{value:!0});ct.insert=ct.search=void 0;function mn(t,e,r){r===void 0&&(r="ticks");var i=0,s=t.length,o=s;if(s>0&&t[s-1][r]<=e)return s-1;for(;i<o;){var n=Math.floor(i+(o-i)/2),l=t[n],f=t[n+1];if(l[r]===e){for(var u=n;u<t.length;u++){var S=t[u];S[r]===e&&(n=u)}return n}else{if(l[r]<e&&f[r]>e)return n;l[r]>e?o=n:l[r]<e&&(i=n+1)}}return-1}ct.search=mn;function fi(t,e,r){if(r===void 0&&(r="ticks"),t.length){var i=mn(t,e[r],r);t.splice(i+1,0,e)}else t.push(e)}ct.insert=fi;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var e=ct,r=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function s(o){var n=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",r.set(this,480),o){r.set(this,o.header.ticksPerBeat),o.tracks.forEach(function(f){f.forEach(function(u){u.meta&&(u.type==="timeSignature"?n.timeSignatures.push({ticks:u.absoluteTime,timeSignature:[u.numerator,u.denominator]}):u.type==="setTempo"?n.tempos.push({bpm:6e7/u.microsecondsPerBeat,ticks:u.absoluteTime}):u.type==="keySignature"&&n.keySignatures.push({key:t.keySignatureKeys[u.key+7],scale:u.scale===0?"major":"minor",ticks:u.absoluteTime}))})});var l=0;o.tracks[0].forEach(function(f){l+=f.deltaTime,f.meta&&(f.type==="trackName"?n.name=f.text:(f.type==="text"||f.type==="cuePoint"||f.type==="marker"||f.type==="lyrics")&&n.meta.push({text:f.text,ticks:l,type:f.type}))}),this.update()}}return s.prototype.update=function(){var o=this,n=0,l=0;this.tempos.sort(function(f,u){return f.ticks-u.ticks}),this.tempos.forEach(function(f,u){var S=u>0?o.tempos[u-1].bpm:o.tempos[0].bpm,_=f.ticks/o.ppq-l,m=60/S*_;f.time=m+n,n=f.time,l+=_}),this.timeSignatures.sort(function(f,u){return f.ticks-u.ticks}),this.timeSignatures.forEach(function(f,u){var S=u>0?o.timeSignatures[u-1]:o.timeSignatures[0],_=(f.ticks-S.ticks)/o.ppq,m=_/S.timeSignature[0]/(S.timeSignature[1]/4);S.measures=S.measures||0,f.measures=m+S.measures})},s.prototype.ticksToSeconds=function(o){var n=(0,e.search)(this.tempos,o);if(n!==-1){var l=this.tempos[n],f=l.time,u=(o-l.ticks)/this.ppq;return f+60/l.bpm*u}else{var S=o/this.ppq;return 60/120*S}},s.prototype.ticksToMeasures=function(o){var n=(0,e.search)(this.timeSignatures,o);if(n!==-1){var l=this.timeSignatures[n],f=(o-l.ticks)/this.ppq;return l.measures+f/(l.timeSignature[0]/l.timeSignature[1])/4}else return o/this.ppq/4},Object.defineProperty(s.prototype,"ppq",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),s.prototype.secondsToTicks=function(o){var n=(0,e.search)(this.tempos,o,"time");if(n!==-1){var l=this.tempos[n],f=l.time,u=o-f,S=u/(60/l.bpm);return Math.round(l.ticks+S*this.ppq)}else{var _=o/.5;return Math.round(_*this.ppq)}},s.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map(function(o){return{bpm:o.bpm,ticks:o.ticks}}),timeSignatures:this.timeSignatures}},s.prototype.fromJSON=function(o){this.name=o.name,this.tempos=o.tempos.map(function(n){return Object.assign({},n)}),this.timeSignatures=o.timeSignatures.map(function(n){return Object.assign({},n)}),this.keySignatures=o.keySignatures.map(function(n){return Object.assign({},n)}),this.meta=o.meta.map(function(n){return Object.assign({},n)}),r.set(this,o.ppq),this.update()},s.prototype.setTempo=function(o){this.tempos=[{bpm:o,ticks:0}],this.update()},s}();t.Header=i})(tr);var Nt={},Gr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce(function(s,o){return s[t.controlChangeNames[o]]=o,s},{});var e=new WeakMap,r=new WeakMap,i=function(){function s(o,n){e.set(this,n),r.set(this,o.controllerType),this.ticks=o.absoluteTime,this.value=o.value}return Object.defineProperty(s.prototype,"number",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"time",{get:function(){var o=e.get(this);return o.ticksToSeconds(this.ticks)},set:function(o){var n=e.get(this);this.ticks=n.secondsToTicks(o)},enumerable:!1,configurable:!0}),s.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},s}();t.ControlChange=i})(Gr);var yr={};Object.defineProperty(yr,"__esModule",{value:!0});yr.createControlChanges=void 0;var Xt=Gr;function ui(){return new Proxy({},{get:function(t,e){if(t[e])return t[e];if(Xt.controlChangeIds.hasOwnProperty(e))return t[Xt.controlChangeIds[e]]},set:function(t,e,r){return Xt.controlChangeIds.hasOwnProperty(e)?t[Xt.controlChangeIds[e]]=r:t[e]=r,!0}})}yr.createControlChanges=ui;var vr={};Object.defineProperty(vr,"__esModule",{value:!0});vr.PitchBend=void 0;var Fr=new WeakMap,li=function(){function t(e,r){Fr.set(this,r),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(t.prototype,"time",{get:function(){var e=Fr.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var r=Fr.get(this);this.ticks=r.secondsToTicks(e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},t}();vr.PitchBend=li;var gr={},it={};Object.defineProperty(it,"__esModule",{value:!0});it.DrumKitByPatchID=it.InstrumentFamilyByID=it.instrumentByPatchID=void 0;it.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"];it.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"];it.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"};Object.defineProperty(gr,"__esModule",{value:!0});gr.Instrument=void 0;var Kt=it,cn=new WeakMap,hi=function(){function t(e,r){if(this.number=0,cn.set(this,r),this.number=0,e){var i=e.find(function(s){return s.type==="programChange"});i&&(this.number=i.programNumber)}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.percussion?Kt.DrumKitByPatchID[this.number]:Kt.instrumentByPatchID[this.number]},set:function(e){var r=Kt.instrumentByPatchID.indexOf(e);r!==-1&&(this.number=r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.percussion?"drums":Kt.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percussion",{get:function(){var e=cn.get(this);return e.channel===9},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},t.prototype.fromJSON=function(e){this.number=e.number},t}();gr.Instrument=hi;var xr={};Object.defineProperty(xr,"__esModule",{value:!0});xr.Note=void 0;function di(t){var e=Math.floor(t/12)-1;return bn(t)+e.toString()}function bn(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],r=t%12;return e[r]}function pi(t){var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return e.indexOf(t)}var mi=function(){var t=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(r){var i=t.exec(r),s=i[1],o=i[2],n=e[s.toLowerCase()];return n+(parseInt(o,10)+1)*12}}(),dt=new WeakMap,bi=function(){function t(e,r,i){dt.set(this,i),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=r.velocity,this.ticks=e.ticks,this.durationTicks=r.ticks-e.ticks}return Object.defineProperty(t.prototype,"name",{get:function(){return di(this.midi)},set:function(e){this.midi=mi(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var r=e-this.octave;this.midi+=r*12},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pitch",{get:function(){return bn(this.midi)},set:function(e){this.midi=12*(this.octave+1)+pi(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){var e=dt.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var r=dt.get(this),i=r.secondsToTicks(this.time+e);this.durationTicks=i-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var e=dt.get(this);return e.ticksToSeconds(this.ticks)},set:function(e){var r=dt.get(this);this.ticks=r.secondsToTicks(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bars",{get:function(){var e=dt.get(this);return e.ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},t}();xr.Note=bi;Object.defineProperty(Nt,"__esModule",{value:!0});Nt.Track=void 0;var Mr=ct,yi=Gr,vi=yr,gi=vr,fn=gr,xi=xr,$t=new WeakMap,ki=function(){function t(e,r){var i=this;if(this.name="",this.notes=[],this.controlChanges=(0,vi.createControlChanges)(),this.pitchBends=[],$t.set(this,r),e){var s=e.find(function(m){return m.type==="trackName"});this.name=s?s.text:""}if(this.instrument=new fn.Instrument(e,this),this.channel=0,e){for(var o=e.filter(function(m){return m.type==="noteOn"}),n=e.filter(function(m){return m.type==="noteOff"}),l=function(){var m=o.shift();f.channel=m.channel;var v=n.findIndex(function(O){return O.noteNumber===m.noteNumber&&O.absoluteTime>=m.absoluteTime});if(v!==-1){var B=n.splice(v,1)[0];f.addNote({durationTicks:B.absoluteTime-m.absoluteTime,midi:m.noteNumber,noteOffVelocity:B.velocity/127,ticks:m.absoluteTime,velocity:m.velocity/127})}},f=this;o.length;)l();var u=e.filter(function(m){return m.type==="controller"});u.forEach(function(m){i.addCC({number:m.controllerType,ticks:m.absoluteTime,value:m.value/127})});var S=e.filter(function(m){return m.type==="pitchBend"});S.forEach(function(m){i.addPitchBend({ticks:m.absoluteTime,value:m.value/Math.pow(2,13)})});var _=e.find(function(m){return m.type==="endOfTrack"});this.endOfTrackTicks=_!==void 0?_.absoluteTime:void 0}}return t.prototype.addNote=function(e){var r=$t.get(this),i=new xi.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},r);return Object.assign(i,e),(0,Mr.insert)(this.notes,i,"ticks"),this},t.prototype.addCC=function(e){var r=$t.get(this),i=new yi.ControlChange({controllerType:e.number},r);return delete e.number,Object.assign(i,e),Array.isArray(this.controlChanges[i.number])||(this.controlChanges[i.number]=[]),(0,Mr.insert)(this.controlChanges[i.number],i,"ticks"),this},t.prototype.addPitchBend=function(e){var r=$t.get(this),i=new gi.PitchBend({},r);return Object.assign(i,e),(0,Mr.insert)(this.pitchBends,i,"ticks"),this},Object.defineProperty(t.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,r=0;r<this.notes.length-1;r++){var i=this.notes[r].time+this.notes[r].duration;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,r=0;r<this.notes.length-1;r++){var i=this.notes[r].ticks+this.notes[r].durationTicks;e<i&&(e=i)}return e},enumerable:!1,configurable:!0}),t.prototype.fromJSON=function(e){var r=this;this.name=e.name,this.channel=e.channel,this.instrument=new fn.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),e.endOfTrackTicks!==void 0&&(this.endOfTrackTicks=e.endOfTrackTicks);for(var i in e.controlChanges)e.controlChanges[i]&&e.controlChanges[i].forEach(function(s){r.addCC({number:s.number,ticks:s.ticks,value:s.value})});e.notes.forEach(function(s){r.addNote({durationTicks:s.durationTicks,midi:s.midi,ticks:s.ticks,velocity:s.velocity})})},t.prototype.toJSON=function(){for(var e={},r=0;r<127;r++)this.controlChanges.hasOwnProperty(r)&&(e[r]=this.controlChanges[r].map(function(s){return s.toJSON()}));var i={channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map(function(s){return s.toJSON()}),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map(function(s){return s.toJSON()})};return this.endOfTrackTicks!==void 0&&(i.endOfTrackTicks=this.endOfTrackTicks),i},t}();Nt.Track=ki;var kr={};function _i(t){var e=[];return yn(t,e),e}function yn(t,e){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?yn(i,e):e.push(i)}}const wi=Object.freeze(Object.defineProperty({__proto__:null,flatten:_i},Symbol.toStringTag,{value:"Module"})),Ii=Qn(wi);var rt=pt&&pt.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var i=0,s=e.length,o;i<s;i++)(o||!(i in e))&&(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(kr,"__esModule",{value:!0});kr.encode=void 0;var Ti=br,Si=tr,Bi=Ii;function Ui(t,e){return[{absoluteTime:t.ticks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOn",velocity:Math.floor(t.velocity*127)},{absoluteTime:t.ticks+t.durationTicks,channel:e,deltaTime:0,noteNumber:t.midi,type:"noteOff",velocity:Math.floor(t.noteOffVelocity*127)}]}function Oi(t){return(0,Bi.flatten)(t.notes.map(function(e){return Ui(e,t.channel)}))}function Ei(t,e){return{absoluteTime:t.ticks,channel:e,controllerType:t.number,deltaTime:0,type:"controller",value:Math.floor(t.value*127)}}function Ni(t){for(var e=[],r=0;r<127;r++)t.controlChanges.hasOwnProperty(r)&&t.controlChanges[r].forEach(function(i){e.push(Ei(i,t.channel))});return e}function Ci(t,e){return{absoluteTime:t.ticks,channel:e,deltaTime:0,type:"pitchBend",value:t.value}}function Fi(t){var e=[];return t.pitchBends.forEach(function(r){e.push(Ci(r,t.channel))}),e}function Mi(t){return{absoluteTime:0,channel:t.channel,deltaTime:0,programNumber:t.instrument.number,type:"programChange"}}function Ai(t){return{absoluteTime:0,deltaTime:0,meta:!0,text:t,type:"trackName"}}function Pi(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/t.bpm),type:"setTempo"}}function Di(t){return{absoluteTime:t.ticks,deltaTime:0,denominator:t.timeSignature[1],meta:!0,metronome:24,numerator:t.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}function Li(t){var e=Si.keySignatureKeys.indexOf(t.key);return{absoluteTime:t.ticks,deltaTime:0,key:e+7,meta:!0,scale:t.scale==="major"?0:1,type:"keySignature"}}function Ri(t){return{absoluteTime:t.ticks,deltaTime:0,meta:!0,text:t.text,type:t.type}}function ji(t){var e={header:{format:1,numTracks:t.tracks.length+1,ticksPerBeat:t.header.ppq},tracks:rt([rt(rt(rt(rt([{absoluteTime:0,deltaTime:0,meta:!0,text:t.header.name,type:"trackName"}],t.header.keySignatures.map(function(r){return Li(r)}),!0),t.header.meta.map(function(r){return Ri(r)}),!0),t.header.tempos.map(function(r){return Pi(r)}),!0),t.header.timeSignatures.map(function(r){return Di(r)}),!0)],t.tracks.map(function(r){return rt(rt(rt([Ai(r.name),Mi(r)],Oi(r),!0),Ni(r),!0),Fi(r),!0)}),!0)};return e.tracks=e.tracks.map(function(r){r=r.sort(function(s,o){return s.absoluteTime-o.absoluteTime});var i=0;return r.forEach(function(s){s.deltaTime=s.absoluteTime-i,i=s.absoluteTime,delete s.absoluteTime}),r.push({deltaTime:0,meta:!0,type:"endOfTrack"}),r}),new Uint8Array((0,Ti.writeMidi)(e))}kr.encode=ji;(function(t){var e=pt&&pt.__awaiter||function(_,m,v,B){function O(w){return w instanceof v?w:new v(function(J){J(w)})}return new(v||(v=Promise))(function(w,J){function H(g){try{h(B.next(g))}catch(U){J(U)}}function V(g){try{h(B.throw(g))}catch(U){J(U)}}function h(g){g.done?w(g.value):O(g.value).then(H,V)}h((B=B.apply(_,m||[])).next())})},r=pt&&pt.__generator||function(_,m){var v={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},B,O,w,J;return J={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(J[Symbol.iterator]=function(){return this}),J;function H(h){return function(g){return V([h,g])}}function V(h){if(B)throw new TypeError("Generator is already executing.");for(;v;)try{if(B=1,O&&(w=h[0]&2?O.return:h[0]?O.throw||((w=O.return)&&w.call(O),0):O.next)&&!(w=w.call(O,h[1])).done)return w;switch(O=0,w&&(h=[h[0]&2,w.value]),h[0]){case 0:case 1:w=h;break;case 4:return v.label++,{value:h[1],done:!1};case 5:v.label++,O=h[1],h=[0];continue;case 7:h=v.ops.pop(),v.trys.pop();continue;default:if(w=v.trys,!(w=w.length>0&&w[w.length-1])&&(h[0]===6||h[0]===2)){v=0;continue}if(h[0]===3&&(!w||h[1]>w[0]&&h[1]<w[3])){v.label=h[1];break}if(h[0]===6&&v.label<w[1]){v.label=w[1],w=h;break}if(w&&v.label<w[2]){v.label=w[2],v.ops.push(h);break}w[2]&&v.ops.pop(),v.trys.pop();continue}h=m.call(_,v)}catch(g){h=[6,g],O=0}finally{B=w=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var i=br,s=tr,o=Nt,n=kr,l=function(){function _(m){var v=this,B=null;if(m){var O=m instanceof ArrayBuffer?new Uint8Array(m):m;B=(0,i.parseMidi)(O),B.tracks.forEach(function(w){var J=0;w.forEach(function(H){J+=H.deltaTime,H.absoluteTime=J})}),B.tracks=S(B.tracks)}this.header=new s.Header(B),this.tracks=[],m&&(this.tracks=B.tracks.map(function(w){return new o.Track(w,v.header)}),B.header.format===1&&this.tracks[0].duration===0&&this.tracks.shift())}return _.fromUrl=function(m){return e(this,void 0,void 0,function(){var v,B;return r(this,function(O){switch(O.label){case 0:return[4,fetch(m)];case 1:return v=O.sent(),v.ok?[4,v.arrayBuffer()]:[3,3];case 2:return B=O.sent(),[2,new _(B)];case 3:throw new Error("Could not load '".concat(m,"'"))}})})},Object.defineProperty(_.prototype,"name",{get:function(){return this.header.name},set:function(m){this.header.name=m},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"duration",{get:function(){var m=this.tracks.map(function(v){return v.duration});return Math.max.apply(Math,m)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"durationTicks",{get:function(){var m=this.tracks.map(function(v){return v.durationTicks});return Math.max.apply(Math,m)},enumerable:!1,configurable:!0}),_.prototype.addTrack=function(){var m=new o.Track(void 0,this.header);return this.tracks.push(m),m},_.prototype.toArray=function(){return(0,n.encode)(this)},_.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map(function(m){return m.toJSON()})}},_.prototype.fromJSON=function(m){var v=this;this.header=new s.Header,this.header.fromJSON(m.header),this.tracks=m.tracks.map(function(B){var O=new o.Track(void 0,v.header);return O.fromJSON(B),O})},_.prototype.clone=function(){var m=new _;return m.fromJSON(this.toJSON()),m},_}();t.Midi=l;var f=Nt;Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return f.Track}});var u=tr;Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return u.Header}});function S(_){for(var m=[],v=0;v<_.length;v++)for(var B=m.length,O=new Map,w=Array(16).fill(0),J=0,H=_[v];J<H.length;J++){var V=H[J],h=B,g=V.channel;if(g!==void 0){V.type==="programChange"&&(w[g]=V.programNumber);var U=w[g],q="".concat(U," ").concat(g);O.has(q)?h=O.get(q):(h=B+O.size,O.set(q,h))}m[h]||m.push([]),m[h].push(V)}return m}})(Ot);class Hi extends Number{constructor(e){const[r]=new Int8Array([e]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Byte"}}class Qt extends Number{constructor(e){const[r]=new Int16Array([e]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Short"}}class ot extends Number{constructor(e){const[r]=new Int32Array([e]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Int"}}class Vi extends Number{constructor(e){const[r]=new Float32Array([e]);super(r)}valueOf(){return super.valueOf()}get[Symbol.toStringTag](){return"Float"}}class Pt{constructor(e,{name:r,endian:i,compression:s,bedrockLevel:o}={}){if(e instanceof Pt&&(r===void 0&&(r=e.name),i===void 0&&(i=e.endian),s===void 0&&(s=e.compression),o===void 0&&(o=e.bedrockLevel),e=e.data),r===void 0&&(r=""),i===void 0&&(i="big"),s===void 0&&(s=null),o===void 0&&(o=null),typeof e!="object"||e===null)throw new TypeError("First parameter must be an object");if(typeof r!="string"&&r!==null)throw new TypeError("Name option must be a string or null");if(i!=="big"&&i!=="little")throw new TypeError("Endian option must be a valid endian type");if(s!==null&&s!=="gzip"&&s!=="deflate")throw new TypeError("Compression option must be a valid compression type");if(o!==null&&!(o instanceof ot))throw new TypeError("Bedrock Level option must be an Int");this.data=e,this.name=r,this.endian=i,s!==null&&(this.compression=s),o!==null&&(this.bedrockLevel=o),Object.freeze(this)}get[Symbol.toStringTag](){return"NBTData"}}const $={END:0,BYTE:1,SHORT:2,INT:3,LONG:4,FLOAT:5,DOUBLE:6,BYTE_ARRAY:7,STRING:8,LIST:9,COMPOUND:10,INT_ARRAY:11,LONG_ARRAY:12};Object.freeze($);function Bt(t){switch(!0){case t instanceof Hi:case typeof t=="boolean":return $.BYTE;case t instanceof Qt:return $.SHORT;case t instanceof ot:return $.INT;case typeof t=="bigint":return $.LONG;case t instanceof Vi:return $.FLOAT;case typeof t=="number":return $.DOUBLE;case t instanceof Int8Array:return $.BYTE_ARRAY;case typeof t=="string":return $.STRING;case t instanceof Array:return $.LIST;case t instanceof Int32Array:return $.INT_ARRAY;case t instanceof BigInt64Array:return $.LONG_ARRAY;case(typeof t=="object"&&t!==null):return $.COMPOUND;default:return null}}async function un(t,{format:e="gzip"}={}){const r=new CompressionStream(e),i=new Blob([t]).stream().pipeThrough(r),s=await new Response(i).arrayBuffer();return new Uint8Array(s)}async function qi(t,{name:e,endian:r,compression:i,bedrockLevel:s}={}){if(t instanceof Pt&&(e===void 0&&(e=t.name),r===void 0&&(r=t.endian),i===void 0&&(i=t.compression),s===void 0&&(s=t.bedrockLevel),t=t.data),typeof t!="object"||t===null)throw new TypeError("First parameter must be an object");if(e!==void 0&&typeof e!="string"&&e!==null)throw new TypeError("Name option must be a string or null");if(r!==void 0&&r!=="big"&&r!=="little")throw new TypeError("Endian option must be a valid endian type");if(i!=null&&i!=="gzip"&&i!=="deflate")throw new TypeError("Compression option must be a valid compression type");if(s!=null&&!(s instanceof ot))throw new TypeError("Bedrock Level option must be an Int");let n=new Ji().write(t,{name:e,endian:r});if(s!=null){const{byteLength:l}=n,f=new Uint8Array(l+8),u=new DataView(f.buffer),S=s.valueOf();u.setUint32(0,S,!0),u.setUint32(4,l,!0),f.set(n,8),n=f}return i==="gzip"&&(n=await un(n,{format:"gzip"})),i==="deflate"&&(n=await un(n,{format:"deflate"})),n}var K,ze,Ae,Pe,nr,Se,Re,Ft,Pr,st,Ut,ir,vn,ar,gn,sr,xn,or,kn,et,at,Mt,Dr,cr,_n,fr,wn,ur,In,mt,er,lr,Tn,At,Lr,hr,Sn,dr,Bn;class Ji{constructor(){ae(this,Se);ae(this,Ft);ae(this,st);ae(this,ir);ae(this,ar);ae(this,sr);ae(this,or);ae(this,et);ae(this,Mt);ae(this,cr);ae(this,fr);ae(this,ur);ae(this,mt);ae(this,lr);ae(this,At);ae(this,hr);ae(this,dr);ae(this,K,void 0);ae(this,ze,void 0);ae(this,Ae,void 0);ae(this,Pe,void 0);ae(this,nr,new TextEncoder)}write(e,{name:r,endian:i}={}){if(e instanceof Pt&&(r===void 0&&(r=e.name),i===void 0&&(i=e.endian),e=e.data),r===void 0&&(r=""),i===void 0&&(i="big"),typeof e!="object"||e===null)throw new TypeError("First parameter must be an object");if(typeof r!="string"&&r!==null)throw new TypeError("Name option must be a string or null");if(i!=="big"&&i!=="little")throw new TypeError("Endian option must be a valid endian type");return ve(this,K,0),ve(this,ze,i==="little"),ve(this,Ae,new Uint8Array(1024)),ve(this,Pe,new DataView(E(this,Ae).buffer)),F(this,st,Ut).call(this,$.COMPOUND),r!==null&&F(this,mt,er).call(this,r),F(this,At,Lr).call(this,e),F(this,Se,Re).call(this,0),E(this,Ae).slice(0,E(this,K))}}K=new WeakMap,ze=new WeakMap,Ae=new WeakMap,Pe=new WeakMap,nr=new WeakMap,Se=new WeakSet,Re=function(e){const r=E(this,K)+e;if(E(this,Ae).byteLength>=r)return;let i=E(this,Ae).byteLength;for(;i<r;)i*=2;const s=new Uint8Array(i);s.set(E(this,Ae),0),E(this,K)>E(this,Ae).byteLength&&s.fill(0,e,E(this,K)),ve(this,Ae,s),ve(this,Pe,new DataView(s.buffer))},Ft=new WeakSet,Pr=function(e){switch(Bt(e)){case $.BYTE:return F(this,ar,gn).call(this,Number(e));case $.SHORT:return F(this,or,kn).call(this,e.valueOf());case $.INT:return F(this,et,at).call(this,e.valueOf());case $.LONG:return F(this,Mt,Dr).call(this,e);case $.FLOAT:return F(this,cr,_n).call(this,e.valueOf());case $.DOUBLE:return F(this,fr,wn).call(this,e);case $.BYTE_ARRAY:return F(this,ur,In).call(this,e);case $.STRING:return F(this,mt,er).call(this,e);case $.LIST:return F(this,lr,Tn).call(this,e);case $.COMPOUND:return F(this,At,Lr).call(this,e);case $.INT_ARRAY:return F(this,hr,Sn).call(this,e);case $.LONG_ARRAY:return F(this,dr,Bn).call(this,e)}},st=new WeakSet,Ut=function(e){F(this,ir,vn).call(this,e)},ir=new WeakSet,vn=function(e){F(this,Se,Re).call(this,1),E(this,Pe).setUint8(E(this,K),e),ve(this,K,E(this,K)+1)},ar=new WeakSet,gn=function(e){F(this,Se,Re).call(this,1),E(this,Pe).setInt8(E(this,K),e),ve(this,K,E(this,K)+1)},sr=new WeakSet,xn=function(e){F(this,Se,Re).call(this,2),E(this,Pe).setUint16(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+2)},or=new WeakSet,kn=function(e){F(this,Se,Re).call(this,2),E(this,Pe).setInt16(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+2)},et=new WeakSet,at=function(e){F(this,Se,Re).call(this,4),E(this,Pe).setInt32(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+4)},Mt=new WeakSet,Dr=function(e){F(this,Se,Re).call(this,8),E(this,Pe).setBigInt64(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+8)},cr=new WeakSet,_n=function(e){F(this,Se,Re).call(this,4),E(this,Pe).setFloat32(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+4)},fr=new WeakSet,wn=function(e){F(this,Se,Re).call(this,8),E(this,Pe).setFloat64(E(this,K),e,E(this,ze)),ve(this,K,E(this,K)+8)},ur=new WeakSet,In=function(e){const{length:r}=e;F(this,et,at).call(this,r),F(this,Se,Re).call(this,r),E(this,Ae).set(e,E(this,K)),ve(this,K,E(this,K)+r)},mt=new WeakSet,er=function(e){const r=E(this,nr).encode(e),{length:i}=r;F(this,sr,xn).call(this,i),F(this,Se,Re).call(this,i),E(this,Ae).set(r,E(this,K)),ve(this,K,E(this,K)+i)},lr=new WeakSet,Tn=function(e){e=e.filter(s=>Bt(s)!==null);const r=e.length!==0?Bt(e[0]):$.END,{length:i}=e;F(this,st,Ut).call(this,r),F(this,et,at).call(this,i);for(const s of e){if(Bt(s)!==r)throw new TypeError("Encountered unexpected item type in array, all tags in a List tag must be of the same type");F(this,Ft,Pr).call(this,s)}},At=new WeakSet,Lr=function(e){for(const[r,i]of Object.entries(e)){const s=Bt(i);s!==null&&(F(this,st,Ut).call(this,s),F(this,mt,er).call(this,r),F(this,Ft,Pr).call(this,i))}F(this,st,Ut).call(this,$.END)},hr=new WeakSet,Sn=function(e){const{length:r}=e;F(this,et,at).call(this,r);for(const i of e)F(this,et,at).call(this,i)},dr=new WeakSet,Bn=function(e){const{length:r}=e;F(this,et,at).call(this,r);for(const i of e)F(this,Mt,Dr).call(this,i)};const Ve=class{constructor(e){Je(this,"name");Je(this,"index");this.name=e,this.index=Ve.maxTags}static create(e){if(Ve.palette[e])return Ve.blocks[Ve.palette[e].valueOf()];const r=new Ve(e);return Ve.maxTags+=1,Ve.blocks.push(r),Ve.palette[r.name]=new ot(r.index),r}static get(e){return Ve.blocks[e]}};let se=Ve;Je(se,"maxTags",0),Je(se,"blocks",[]),Je(se,"palette",{});class Gi{constructor(e,r,i){Je(this,"width");Je(this,"height");Je(this,"length");Je(this,"blockData");this.width=new Qt(e),this.height=new Qt(r),this.length=new Qt(i),this.blockData=new Int8Array(e*r*i).fill(0)}positionToIndex(e,r,i){return e+i*this.width.valueOf()+r*this.width.valueOf()*this.length.valueOf()}setBlock(e,r,i,s){this.blockData[this.positionToIndex(e,r,i)]=s.index.valueOf()}getBlock(e,r,i){return this.blockData[this.positionToIndex(e,r,i)]}get Width(){return this.width.valueOf()}get Height(){return this.height.valueOf()}get Length(){return this.length.valueOf()}toNBT(){const e={Version:new ot(2),DataVersion:new ot(2975),Width:this.width,Height:this.height,Length:this.length,BlockData:this.blockData,PaletteMax:new ot(se.maxTags),Palette:se.palette};return new Pt(e,{name:"Schematic"})}}const ln=se.create("minecraft:air"),Rr=se.create("minecraft:repeater"),Ye=se.create("minecraft:white_concrete"),Ue=se.create("minecraft:redstone_wire"),jr=se.create("minecraft:observer[facing=down]"),Wi=se.create("minecraft:powered_rail[shape=east_west]"),zi=se.create("minecraft:redstone_block"),Hr=se.create("minecraft:redstone_lamp"),Yi=se.create("minecraft:sticky_piston[facing=south]"),Xi=se.create("minecraft:lever[face=floor]"),Ki=[se.create("minecraft:oak_planks"),se.create("minecraft:white_wool"),se.create("minecraft:dirt"),se.create("minecraft:clay"),se.create("minecraft:gold_block")],$i=t=>{for(let e=0;e<t.Width;e++)for(let r=0;r<t.Length;r++)t.setBlock(e,0,r,Ye),t.setBlock(e,6,r,Ye)},Zi=(t,e,r=0)=>{const i=(r+5)%2;for(let s=0;s<t.Length;s++)s>=5&&(s%2==i?(t.setBlock(e+1,1,s,Rr),t.setBlock(e-1,1,s,Rr)):(t.setBlock(e+1,1,s,Hr),t.setBlock(e-1,1,s,Hr)))},Qi=(t,e,r=0)=>{const i=(r+5)%2;for(let s=r+5;s<t.Length;s++)s%2!==i?t.setBlock(e+1,2,s,jr):t.setBlock(e-1,2,s,jr)},ea=(t,e=0)=>{for(let r=e+5;r<t.Length;r++)for(let i=0;i<t.Width;i++)t.setBlock(i,3,r,Ye),t.setBlock(i,4,r,Wi),t.setBlock(i,5,r,jr)},ta=(t,e,r=0)=>{for(let i=r+5;i<t.Length;i++)t.setBlock(e,7,i,Hr)},ra=(t,e,r=0)=>{$i(t),Zi(t,e,r),Qi(t,e,r),ea(t,r),ta(t,e,r)},na=(t,e,r=0)=>{t.setBlock(e,7,r,Xi),ia(t,e,r),aa(t,e,r),sa(t,e,r)},ia=(t,e,r=0)=>{t.setBlock(e,5,r+0,Ue),t.setBlock(e,4,r+0,Ye),t.setBlock(e,4,r+1,Ue),t.setBlock(e,3,r+1,Ye),t.setBlock(e+1,3,r+1,Ue),t.setBlock(e+1,2,r+1,Ye),t.setBlock(e+1,2,r+0,Ue),t.setBlock(e+1,1,r+0,Ye)},aa=(t,e,r=0)=>{t.setBlock(e+1,1,r+1,Rr),t.setBlock(e+1,1,r+2,Ue),t.setBlock(e+1,1,r+3,Ue),t.setBlock(e+1,1,r+4,Ue)},sa=(t,e,r=0)=>{t.setBlock(e,1,r,Ue),t.setBlock(e-1,1,r,Ue),t.setBlock(e-2,1,r,Ue),t.setBlock(e-2,1,r+1,Ye),t.setBlock(e-2,2,r+1,Ue),t.setBlock(e-2,2,r+2,Yi),t.setBlock(e-2,2,r+3,Ye),t.setBlock(e-2,1,r+3,Ue),t.setBlock(e-2,0,r+3,zi),t.setBlock(e-1,1,r+3,Ye),t.setBlock(e-1,2,r+3,Ue),t.setBlock(e-1,1,r+4,Ue)},Un=t=>Math.round(t*15),oa=(t,e,r,i,s)=>{let o=e-Math.round(r.velocity*e);const n=Un(r.time)+s+5,l=se.create(`minecraft:note_block[note=${r.midi-54}]`),f=o>e/2?-1:1;for(;o>0&&o<=e;){if(t.getBlock(e+o,7,n)===ln.index){t.setBlock(e+o,7,n,l),t.setBlock(e+o,6,n,i);break}else if(t.getBlock(e-o,7,n)===ln.index){t.setBlock(e-o,7,n,l),t.setBlock(e-o,6,n,i);break}o+=f}},ca=(t,e,r,i=0)=>{r.tracks.forEach((s,o)=>{s.notes.forEach(n=>{oa(t,e,n,Ki[o],i)})})},fa=(t,e=7,r=5)=>{const i=new Gi(e*2+1,8,Un(t.duration+1));return ra(i,e,r),na(i,e,r),ca(i,e,t,r),i.toNBT()},Zt=[6,30,54,78,102,126],ua=t=>{const e=new Ot.Midi;for(let r=0;r<Zt.length-1;r++){const i=54-Zt[r],s=new Ot.Track([],new Ot.Header);t.tracks.forEach(o=>{o.notes.forEach(n=>{Zt[r]<n.midi&&n.midi<Zt[r+1]&&(n.midi+=i,s.addNote(n))})}),e.tracks.push(s)}return e};var Vr={},la={get exports(){return Vr},set exports(t){Vr=t}},Ct={},ha={get exports(){return Ct},set exports(t){Ct=t}};(function(){var t=[],e=3988292384;function r(){var n,l,f;for(l=0;l<256;l+=1){for(n=l,f=0;f<8;f+=1)n&1?n=e^n>>>1:n=n>>>1;t[l]=n>>>0}}function i(n){return Array.prototype.map.call(n,function(l){return l.charCodeAt(0)})}function s(n){var l=-1,f,u,S,_;for(f=0,S=n.length;f<S;f+=1){for(_=(l^n[f])&255,u=0;u<8;u+=1)(_&1)===1?_=_>>>1^e:_=_>>>1;l=l>>>8^_}return l^-1}function o(n,l){var f,u,S;if(!((typeof o.crc>"u"||!l||!n)&&(o.crc=-1,!n))){for(f=o.crc,u=0,S=n.length;u<S;u+=1)f=f>>>8^t[(f^n[u])&255];return o.crc=f,f^-1}}r(),ha.exports=function(f,l){var f=typeof f=="string"?i(f):f,u=l?s(f):o(f);return(u>>>0).toString(16)},Ct.direct=s,Ct.table=o})();var qr={},da={get exports(){return qr},set exports(t){qr=t}},Jr={},pa={get exports(){return Jr},set exports(t){Jr=t}};(function(){var t=32768,e=0,r=1,i=2,s=9,o=6,n,l,f=null,u,S,_,m,v,B,O,w,J,H,V,h,g,U,q,W=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],he=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],we=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function bt(){this.next=null,this.list=null}function ft(){this.e=0,this.b=0,this.n=0,this.t=null}function Xe(D,L,M,d,x,C){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var Oe,ce=[],z,te,N,R,k,I,Ee,Ne=[],fe,be,Ce,X=new ft,xe=[],Fe=[],ie,re=[],ye,pe,me,ue,Y;for(Y=this.root=null,k=0;k<this.BMAX+1;k++)ce[k]=0;for(k=0;k<this.BMAX+1;k++)Ne[k]=0;for(k=0;k<this.BMAX;k++)xe[k]=null;for(k=0;k<this.N_MAX;k++)Fe[k]=0;for(k=0;k<this.BMAX+1;k++)re[k]=0;z=L>256?D[256]:this.BMAX,fe=D,be=0,k=L;do ce[fe[be]]++,be++;while(--k>0);if(ce[0]===L){this.root=null,this.m=0,this.status=0;return}for(I=1;I<=this.BMAX&&ce[I]===0;I++);for(Ee=I,C<I&&(C=I),k=this.BMAX;k!==0&&ce[k]===0;k--);for(N=k,C>k&&(C=k),pe=1<<I;I<k;I++,pe<<=1)if((pe-=ce[I])<0){this.status=2,this.m=C;return}if((pe-=ce[k])<0){this.status=2,this.m=C;return}for(ce[k]+=pe,re[1]=I=0,fe=ce,be=1,ye=2;--k>0;)re[ye++]=I+=fe[be++];fe=D,be=0,k=0;do(I=fe[be++])!==0&&(Fe[re[I]++]=k);while(++k<L);for(L=re[N],re[0]=k=0,fe=Fe,be=0,R=-1,ie=Ne[0]=0,Ce=null,me=0,null;Ee<=N;Ee++)for(Oe=ce[Ee];Oe-- >0;){for(;Ee>ie+Ne[1+R];){if(ie+=Ne[1+R],R++,me=(me=N-ie)>C?C:me,(te=1<<(I=Ee-ie))>Oe+1)for(te-=Oe+1,ye=Ee;++I<me&&!((te<<=1)<=ce[++ye]);)te-=ce[ye];for(ie+I>z&&ie<z&&(I=z-ie),me=1<<I,Ne[1+R]=I,Ce=[],ue=0;ue<me;ue++)Ce[ue]=new ft;Y?Y=Y.next=new bt:Y=this.root=new bt,Y.next=null,Y.list=Ce,xe[R]=Ce,R>0&&(re[R]=k,X.b=Ne[R],X.e=16+I,X.t=Ce,I=(k&(1<<ie)-1)>>ie-Ne[R],xe[R-1][I].e=X.e,xe[R-1][I].b=X.b,xe[R-1][I].n=X.n,xe[R-1][I].t=X.t)}for(X.b=Ee-ie,be>=L?X.e=99:fe[be]<M?(X.e=fe[be]<256?16:15,X.n=fe[be++]):(X.e=x[fe[be]-M],X.n=d[fe[be++]-M]),te=1<<Ee-ie,I=k>>ie;I<me;I+=te)Ce[I].e=X.e,Ce[I].b=X.b,Ce[I].n=X.n,Ce[I].t=X.t;for(I=1<<Ee-1;k&I;I>>=1)k^=I;for(k^=I;(k&(1<<ie)-1)!==re[R];)ie-=Ne[R],R--}this.m=Ne[1],this.status=pe!==0&&N!==1?1:0}function Ke(){return U.length===q?-1:U[q++]&255}function P(D){for(;v<D;)m|=Ke()<<v,v+=8}function ne(D){return m&W[D]}function ee(D){m>>=D,v-=D}function Le(D,L,M){var d,x,C;if(M===0)return 0;for(C=0;;){for(P(h),x=H.list[ne(h)],d=x.e;d>16;){if(d===99)return-1;ee(x.b),d-=16,P(d),x=x.t[ne(d)],d=x.e}if(ee(x.b),d===16){if(l&=t-1,D[L+C++]=n[l++]=x.n,C===M)return M;continue}if(d===15)break;for(P(d),w=x.n+ne(d),ee(d),P(g),x=V.list[ne(g)],d=x.e;d>16;){if(d===99)return-1;ee(x.b),d-=16,P(d),x=x.t[ne(d)],d=x.e}for(ee(x.b),P(d),J=l-x.n-ne(d),ee(d);w>0&&C<M;)w--,J&=t-1,l&=t-1,D[L+C++]=n[l++]=n[J++];if(C===M)return M}return B=-1,C}function ge(D,L,M){var d;if(d=v&7,ee(d),P(16),d=ne(16),ee(16),P(16),d!==(~m&65535))return-1;for(ee(16),w=d,d=0;w>0&&d<M;)w--,l&=t-1,P(8),D[L+d++]=n[l++]=ne(8),ee(8);return w===0&&(B=-1),d}function de(D,L,M){if(!f){var d,x=[],C;for(d=0;d<144;d++)x[d]=8;for(null;d<256;d++)x[d]=9;for(null;d<280;d++)x[d]=7;for(null;d<288;d++)x[d]=8;if(S=7,C=new Xe(x,288,257,oe,he,S),C.status!==0)return console.error("HufBuild error: "+C.status),-1;for(f=C.root,S=C.m,d=0;d<30;d++)x[d]=5;if(_=5,C=new Xe(x,30,0,_e,we,_),C.status>1)return f=null,console.error("HufBuild error: "+C.status),-1;u=C.root,_=C.m}return H=f,V=u,h=S,g=_,Le(D,L,M)}function ut(D,L,M){var d,x,C,Oe,ce,z,te,N,R=[],k;for(d=0;d<286+30;d++)R[d]=0;if(P(5),te=257+ne(5),ee(5),P(5),N=1+ne(5),ee(5),P(4),z=4+ne(4),ee(4),te>286||N>30)return-1;for(x=0;x<z;x++)P(3),R[De[x]]=ne(3),ee(3);for(null;x<19;x++)R[De[x]]=0;if(h=7,k=new Xe(R,19,19,null,null,h),k.status!==0)return-1;for(H=k.root,h=k.m,Oe=te+N,d=C=0;d<Oe;)if(P(h),ce=H.list[ne(h)],x=ce.b,ee(x),x=ce.n,x<16)R[d++]=C=x;else if(x===16){if(P(2),x=3+ne(2),ee(2),d+x>Oe)return-1;for(;x-- >0;)R[d++]=C}else if(x===17){if(P(3),x=3+ne(3),ee(3),d+x>Oe)return-1;for(;x-- >0;)R[d++]=0;C=0}else{if(P(7),x=11+ne(7),ee(7),d+x>Oe)return-1;for(;x-- >0;)R[d++]=0;C=0}if(h=s,k=new Xe(R,te,257,oe,he,h),h===0&&(k.status=1),k.status!==0&&k.status!==1)return-1;for(H=k.root,h=k.m,d=0;d<N;d++)R[d]=R[d+te];return g=o,k=new Xe(R,N,0,_e,we,g),V=k.root,g=k.m,g===0&&te>257||k.status!==0?-1:Le(D,L,M)}function Z(){n||(n=[]),l=0,m=0,v=0,B=-1,O=!1,w=J=0,H=null}function yt(D,L,M){var d,x;for(d=0;d<M;){if(O&&B===-1)return d;if(w>0){if(B!==e)for(;w>0&&d<M;)w--,J&=t-1,l&=t-1,D[L+d++]=n[l++]=n[J++];else{for(;w>0&&d<M;)w--,l&=t-1,P(8),D[L+d++]=n[l++]=ne(8),ee(8);w===0&&(B=-1)}if(d===M)return d}if(B===-1){if(O)break;P(1),ne(1)!==0&&(O=!0),ee(1),P(2),B=ne(2),ee(2),H=null,w=0}switch(B){case e:x=ge(D,L+d,M-d);break;case r:H?x=Le(D,L+d,M-d):x=de(D,L+d,M-d);break;case i:H?x=Le(D,L+d,M-d):x=ut(D,L+d,M-d);break;default:x=-1;break}if(x===-1)return O?0:-1;d+=x}return d}function vt(D){var L=[],M;Z(),U=D,q=0;do M=yt(L,L.length,1024);while(M>0);return U=null,L}pa.exports=vt})();var rr={},ma={get exports(){return rr},set exports(t){rr=t}};(function(){var t=32768,e=0,r=1,i=2,s=6,o=1024*8,n=2*t,l=3,f=258,u=8192,S=15,_=u,m=1<<S,v=m-1,B=t-1,O=0,w=4096,J=f+l+1,H=t-J,V=1,h=15,g=7,U=29,q=256,W=256,oe=q+1+U,he=30,_e=19,we=16,De=17,bt=18,ft=2*oe+1,Xe=parseInt((S+l-1)/l,10),Ke,P,ne,ee,Le=null,ge,de,ut,Z,yt,vt,D,L,M,d,x,C,Oe,ce,z,te,N,R,k,I,Ee,Ne,fe,be,Ce,X,xe,Fe,ie,re,ye,pe,me,ue,Y,$e,lt,He,gt,xt,_r,Dt,Lt,Ze,Rt,wr,kt,jt,ht,Ht,Vt,Ir;function _t(){this.fc=0,this.dl=0}function Tr(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0}function qe(a,c,y,p){this.good_length=a,this.max_lazy=c,this.nice_length=y,this.max_chain=p}function On(){this.next=null,this.len=0,this.ptr=[],this.off=0}var Sr=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],wt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],En=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Wr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qt=[new qe(0,0,0,0),new qe(4,4,8,4),new qe(4,5,16,8),new qe(4,6,32,32),new qe(4,4,16,16),new qe(8,16,32,32),new qe(8,16,128,128),new qe(8,32,128,256),new qe(32,128,258,1024),new qe(32,258,258,4096)];function Nn(a){var c;if(a?a<1?a=1:a>9&&(a=9):a=s,fe=a,ee=!1,k=!1,Le===null){for(Ke=P=ne=null,Le=[],Z=[],yt=[],vt=[],D=[],X=[],c=0;c<ft;c++)X[c]=new _t;for(xe=[],c=0;c<2*he+1;c++)xe[c]=new _t;for(Fe=[],c=0;c<oe+2;c++)Fe[c]=new _t;for(ie=[],c=0;c<he;c++)ie[c]=new _t;for(re=[],c=0;c<2*_e+1;c++)re[c]=new _t;ye=new Tr,pe=new Tr,me=new Tr,ue=[],Y=[],He=[],gt=[],xt=[],_r=[],Dt=[],Lt=[]}}function Cn(a){a.next=Ke,Ke=a}function Fn(){var a;return Ke!==null?(a=Ke,Ke=Ke.next):a=new On,a.next=null,a.len=a.off=0,a}function zr(a){return D[t+a]}function Yr(a,c){return D[t+a]=c}function Jt(a){Le[de+ge++]=a,de+ge===o&&qn()}function Gt(a){a&=65535,de+ge<o-2?(Le[de+ge++]=a&255,Le[de+ge++]=a>>>8):(Jt(a&255),Jt(a>>>8))}function Wt(){x=(x<<Xe^Z[N+l-1]&255)&v,C=zr(x),D[N&B]=C,Yr(x,N)}function Qe(a,c){Me(c[a].fc,c[a].dl)}function Xr(a){return(a<256?xt[a]:xt[256+(a>>7)])&255}function Kr(a,c,y){return a[c].fc<a[y].fc||a[c].fc===a[y].fc&&He[c]<=He[y]}function $r(a,c,y){var p;for(p=0;p<y&&Ir<Vt.length;p++)a[c+p]=Vt[Ir++]&255;return p}function Mn(){var a;for(a=0;a<m;a++)D[t+a]=0;if(Ne=qt[fe].max_lazy,be=qt[fe].good_length,Ce=qt[fe].nice_length,Ee=qt[fe].max_chain,N=0,d=0,I=$r(Z,0,2*t),I<=0){k=!0,I=0;return}for(k=!1;I<J&&!k;)Br();for(x=0,a=0;a<l-1;a++)x=(x<<Xe^Z[a]&255)&v}function Zr(a){var c=Ee,y=N,p,b,T=te,j=N>H?N-H:O,G=N+f,A=Z[y+T-1],ke=Z[y+T],Q,tt;te>=be&&(c>>=2);do if(p=a,!(Z[p+T]!==ke||Z[p+T-1]!==A||Z[p]!==Z[y]||Z[++p]!==Z[y+1])){for(y+=2,p++;y<G;){for(tt=!1,Q=0;Q<8;Q+=1)if(y+=1,p+=1,Z[y]!==Z[p]){tt=!0;break}if(tt)break}if(b=f-(G-y),y=G-f,b>T){if(R=a,T=b,b>=Ce)break;A=Z[y+T-1],ke=Z[y+T]}}while((a=D[a&B])>j&&--c!==0);return T}function Br(){var a,c,y=n-I-N;if(y===-1)y--;else if(N>=t+H){for(a=0;a<t;a++)Z[a]=Z[a+t];for(R-=t,N-=t,d-=t,a=0;a<m;a++)c=zr(a),Yr(a,c>=t?c-t:O);for(a=0;a<t;a++)c=D[a],D[a]=c>=t?c-t:O;y+=t}k||(a=$r(Z,N+I,y),a<=0?k=!0:I+=a)}function An(){for(;I!==0&&P===null;){var a;if(Wt(),C!==O&&N-C<=H&&(z=Zr(C),z>I&&(z=I)),z>=l)if(a=It(N-R,z-l),I-=z,z<=Ne){z--;do N++,Wt();while(--z!==0);N++}else N+=z,z=0,x=Z[N]&255,x=(x<<Xe^Z[N+1]&255)&v;else a=It(0,Z[N]&255),I--,N++;for(a&&(zt(0),d=N);I<J&&!k;)Br()}}function Pn(){for(;I!==0&&P===null;){if(Wt(),te=z,Oe=R,z=l-1,C!==O&&te<Ne&&N-C<=H&&(z=Zr(C),z>I&&(z=I),z===l&&N-R>w&&z--),te>=l&&z<=te){var a;a=It(N-1-Oe,te-l),I-=te-1,te-=2;do N++,Wt();while(--te!==0);ce=!1,z=l-1,N++,a&&(zt(0),d=N)}else ce?(It(0,Z[N-1]&255)&&(zt(0),d=N),N++,I--):(ce=!0,N++,I--);for(;I<J&&!k;)Br()}}function Dn(){k||(L=0,M=0,Rn(),Mn(),P=null,ge=0,de=0,fe<=3?(te=l-1,z=0):(z=l-1,ce=!1),ut=!1)}function Ln(a,c,y){var p;return!ee&&(Dn(),ee=!0,I===0)?(ut=!0,0):(p=Qr(a,c,y),p===y?y:ut?p:(fe<=3?An():Pn(),I===0&&(ce&&It(0,Z[N-1]&255),zt(1),ut=!0),p+Qr(a,p+c,y-p)))}function Qr(a,c,y){var p,b,T;for(p=0;P!==null&&p<y;){for(b=y-p,b>P.len&&(b=P.len),T=0;T<b;T++)a[c+p+T]=P.ptr[P.off+T];if(P.off+=b,P.len-=b,p+=b,P.len===0){var j;j=P,P=P.next,Cn(j)}}if(p===y)return p;if(de<ge){for(b=y-p,b>ge-de&&(b=ge-de),T=0;T<b;T++)a[c+p+T]=Le[de+T];de+=b,p+=b,ge===de&&(ge=de=0)}return p}function Rn(){var a,c,y,p,b;if(ie[0].dl===0){for(ye.dyn_tree=X,ye.static_tree=Fe,ye.extra_bits=Sr,ye.extra_base=q+1,ye.elems=oe,ye.max_length=h,ye.max_code=0,pe.dyn_tree=xe,pe.static_tree=ie,pe.extra_bits=wt,pe.extra_base=0,pe.elems=he,pe.max_length=h,pe.max_code=0,me.dyn_tree=re,me.static_tree=null,me.extra_bits=En,me.extra_base=0,me.elems=_e,me.max_length=g,me.max_code=0,y=0,p=0;p<U-1;p++)for(_r[p]=y,a=0;a<1<<Sr[p];a++)gt[y++]=p;for(gt[y-1]=p,b=0,p=0;p<16;p++)for(Dt[p]=b,a=0;a<1<<wt[p];a++)xt[b++]=p;for(b>>=7;p<he;p++)for(Dt[p]=b<<7,a=0;a<1<<wt[p]-7;a++)xt[256+b++]=p;for(c=0;c<=h;c++)ue[c]=0;for(a=0;a<=143;)Fe[a++].dl=8,ue[8]++;for(;a<=255;)Fe[a++].dl=9,ue[9]++;for(;a<=279;)Fe[a++].dl=7,ue[7]++;for(;a<=287;)Fe[a++].dl=8,ue[8]++;for(tn(Fe,oe+1),a=0;a<he;a++)ie[a].dl=5,ie[a].fc=sn(a,5);en()}}function en(){var a;for(a=0;a<oe;a++)X[a].fc=0;for(a=0;a<he;a++)xe[a].fc=0;for(a=0;a<_e;a++)re[a].fc=0;X[W].fc=1,ht=Ht=0,Ze=Rt=wr=0,kt=0,jt=1}function Ur(a,c){for(var y=Y[c],p=c<<1;p<=$e&&(p<$e&&Kr(a,Y[p+1],Y[p])&&p++,!Kr(a,y,Y[p]));)Y[c]=Y[p],c=p,p<<=1;Y[c]=y}function jn(a){var c=a.dyn_tree,y=a.extra_bits,p=a.extra_base,b=a.max_code,T=a.max_length,j=a.static_tree,G,A,ke,Q,tt,Nr,Yt=0;for(Q=0;Q<=h;Q++)ue[Q]=0;for(c[Y[lt]].dl=0,G=lt+1;G<ft;G++)A=Y[G],Q=c[c[A].dl].dl+1,Q>T&&(Q=T,Yt++),c[A].dl=Q,!(A>b)&&(ue[Q]++,tt=0,A>=p&&(tt=y[A-p]),Nr=c[A].fc,ht+=Nr*(Q+tt),j!==null&&(Ht+=Nr*(j[A].dl+tt)));if(Yt!==0){do{for(Q=T-1;ue[Q]===0;)Q--;ue[Q]--,ue[Q+1]+=2,ue[T]--,Yt-=2}while(Yt>0);for(Q=T;Q!==0;Q--)for(A=ue[Q];A!==0;)ke=Y[--G],!(ke>b)&&(c[ke].dl!==Q&&(ht+=(Q-c[ke].dl)*c[ke].fc,c[ke].fc=Q),A--)}}function tn(a,c){var y=[],p=0,b,T;for(b=1;b<=h;b++)p=p+ue[b-1]<<1,y[b]=p;for(T=0;T<=c;T++){var j=a[T].dl;j!==0&&(a[T].fc=sn(y[j]++,j))}}function Or(a){var c=a.dyn_tree,y=a.static_tree,p=a.elems,b,T,j=-1,G=p;for($e=0,lt=ft,b=0;b<p;b++)c[b].fc!==0?(Y[++$e]=j=b,He[b]=0):c[b].dl=0;for(;$e<2;){var A=Y[++$e]=j<2?++j:0;c[A].fc=1,He[A]=0,ht--,y!==null&&(Ht-=y[A].dl)}for(a.max_code=j,b=$e>>1;b>=1;b--)Ur(c,b);do b=Y[V],Y[V]=Y[$e--],Ur(c,V),T=Y[V],Y[--lt]=b,Y[--lt]=T,c[G].fc=c[b].fc+c[T].fc,He[b]>He[T]+1?He[G]=He[b]:He[G]=He[T]+1,c[b].dl=c[T].dl=G,Y[V]=G++,Ur(c,V);while($e>=2);Y[--lt]=Y[V],jn(a),tn(c,j)}function rn(a,c){var y,p=-1,b,T=a[0].dl,j=0,G=7,A=4;for(T===0&&(G=138,A=3),a[c+1].dl=65535,y=0;y<=c;y++)b=T,T=a[y+1].dl,!(++j<G&&b===T)&&(j<A?re[b].fc+=j:b!==0?(b!==p&&re[b].fc++,re[we].fc++):j<=10?re[De].fc++:re[bt].fc++,j=0,p=b,T===0?(G=138,A=3):b===T?(G=6,A=3):(G=7,A=4))}function nn(a,c){var y,p=-1,b,T=a[0].dl,j=0,G=7,A=4;for(T===0&&(G=138,A=3),y=0;y<=c;y++)if(b=T,T=a[y+1].dl,!(++j<G&&b===T)){if(j<A)do Qe(b,re);while(--j!==0);else b!==0?(b!==p&&(Qe(b,re),j--),Qe(we,re),Me(j-3,2)):j<=10?(Qe(De,re),Me(j-3,3)):(Qe(bt,re),Me(j-11,7));j=0,p=b,T===0?(G=138,A=3):b===T?(G=6,A=3):(G=7,A=4)}}function Hn(){var a;for(rn(X,ye.max_code),rn(xe,pe.max_code),Or(me),a=_e-1;a>=3&&re[Wr[a]].dl===0;a--);return ht+=3*(a+1)+5+5+4,a}function Vn(a,c,y){var p;for(Me(a-257,5),Me(c-1,5),Me(y-4,4),p=0;p<y;p++)Me(re[Wr[p]].dl,3);nn(X,a-1),nn(xe,c-1)}function zt(a){var c,y,p,b,T;if(b=N-d,Lt[wr]=kt,Or(ye),Or(pe),p=Hn(),c=ht+3+7>>3,y=Ht+3+7>>3,y<=c&&(c=y),b+4<=c&&d>=0)for(Me((e<<1)+a,3),on(),Gt(b),Gt(~b),T=0;T<b;T++)Jt(Z[d+T]);else y===c?(Me((r<<1)+a,3),an(Fe,ie)):(Me((i<<1)+a,3),Vn(ye.max_code+1,pe.max_code+1,p+1),an(X,xe));en(),a!==0&&on()}function It(a,c){if(vt[Ze++]=c,a===0?X[c].fc++:(a--,X[gt[c]+q+1].fc++,xe[Xr(a)].fc++,yt[Rt++]=a,kt|=jt),jt<<=1,Ze&7||(Lt[wr++]=kt,kt=0,jt=1),fe>2&&!(Ze&4095)){var y=Ze*8,p=N-d,b;for(b=0;b<he;b++)y+=xe[b].fc*(5+wt[b]);if(y>>=3,Rt<parseInt(Ze/2,10)&&y<parseInt(p/2,10))return!0}return Ze===u-1||Rt===_}function an(a,c){var y,p,b=0,T=0,j=0,G=0,A,ke;if(Ze!==0)do b&7||(G=Lt[j++]),p=vt[b++]&255,G&1?(A=gt[p],Qe(A+q+1,a),ke=Sr[A],ke!==0&&(p-=_r[A],Me(p,ke)),y=yt[T++],A=Xr(y),Qe(A,c),ke=wt[A],ke!==0&&(y-=Dt[A],Me(y,ke))):Qe(p,a),G>>=1;while(b<Ze);Qe(W,a)}var Er=16;function Me(a,c){M>Er-c?(L|=a<<M,Gt(L),L=a>>Er-M,M+=c-Er):(L|=a<<M,M+=c)}function sn(a,c){var y=0;do y|=a&1,a>>=1,y<<=1;while(--c>0);return y>>1}function on(){M>8?Gt(L):M>0&&Jt(L),L=0,M=0}function qn(){var a,c;if(ge!==0){for(a=Fn(),P===null?P=ne=a:ne=ne.next=a,a.len=ge-de,c=0;c<a.len;c++)a.ptr[c]=Le[de+c];ge=de=0}}function Jn(a,c){var y,p;Vt=a,Ir=0,typeof c>"u"&&(c=s),Nn(c),p=[];do y=Ln(p,p.length,1024);while(y>0);return Vt=null,p}ma.exports=Jn,rr.DEFAULT_LEVEL=s})();(function(){da.exports={inflate:Jr,deflate:rr}})();(function(){var t=Ct,e=qr,r=31,i=139,s={deflate:8},o={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16},n={fat:0,amiga:1,vmz:2,unix:3,"vm/cms":4,atari:5,hpfs:6,macintosh:7,"z-system":8,cplm:9,"tops-20":10,ntfs:11,qdos:12,acorn:13,vfat:14,vms:15,beos:16,tandem:17,theos:18},l="unix",f=6;function u(h,g){g.push(h&255)}function S(h,g){g.push(h&255),g.push(h>>>8)}function _(h,g){S(h&65535,g),S(h>>>16,g)}function m(h,g){var U,q=h.length;for(U=0;U<q;U+=1)u(h.charCodeAt(U),g)}function v(h){return h.shift()}function B(h){return h.shift()|h.shift()<<8}function O(h){var g=B(h),U=B(h);return U>32768?(U-=32768,(U<<16|g)+32768*Math.pow(2,16)):U<<16|g}function w(h){for(var g=[];h[0]!==0;)g.push(String.fromCharCode(h.shift()));return h.shift(),g.join("")}function J(h,g){var U,q=[];for(U=0;U<g;U+=1)q.push(h.shift());return q}function H(h,g){var U=0,q,W=[];return g||(g={}),q=g.level||f,typeof h=="string"&&(h=Array.prototype.map.call(h,function(oe){return oe.charCodeAt(0)})),u(r,W),u(i,W),u(s.deflate,W),g.name&&(U|=o.FNAME),u(U,W),_(g.timestamp||parseInt(Date.now()/1e3,10),W),u(q===1?4:q===9?2:0,W),u(n[l],W),g.name&&(m(g.name.substring(g.name.lastIndexOf("/")+1),W),u(0,W)),e.deflate(h,q).forEach(function(oe){u(oe,W)}),_(parseInt(t(h),16),W),_(h.length,W),W}function V(h,g){var U=Array.prototype.slice.call(h,0),q,W,oe,he,_e,we;if(v(U)!==r||v(U)!==i)throw"Not a GZIP file";if(q=v(U),q=Object.keys(s).some(function(De){return W=De,s[De]===q}),!q)throw"Unsupported compression method";if(oe=v(U),O(U),v(U),q=v(U),Object.keys(n).some(function(De){if(n[De]===q)return!0}),oe&o.FEXTRA&&(q=B(U),J(U,q)),oe&o.FNAME&&w(U),oe&o.FCOMMENT&&w(U),oe&o.FHCRC&&B(U),W==="deflate"&&(we=e.inflate(U.splice(0,U.length-8))),oe&o.FTEXT&&(we=Array.prototype.map.call(we,function(De){return String.fromCharCode(De)}).join("")),he=O(U),he!==parseInt(t(we),16))throw"Checksum does not match";if(_e=O(U),_e!==we.length)throw"Size of decompressed file not correct";return we}la.exports={zip:H,unzip:V,get DEFAULT_LEVEL(){return f}}})();const{document:hn}=$n;function ba(t){let e=t[1].name+"",r;return{c(){r=pr(e)},l(i){r=mr(i,e)},m(i,s){Et(i,r,s)},p(i,s){s&2&&e!==(e=i[1].name+"")&&Zn(r,e)},d(i){i&&Be(r)}}}function ya(t){let e;return{c(){e=pr("Upload a file")},l(r){e=mr(r,"Upload a file")},m(r,i){Et(r,e,i)},p:Ar,d(r){r&&Be(e)}}}function dn(t){let e,r,i,s,o,n;return{c(){e=Ge("div"),r=Ge("button"),i=pr("Create"),this.h()},l(l){e=We(l,"DIV",{class:!0});var f=nt(e);r=We(f,"BUTTON",{class:!0});var u=nt(r);i=mr(u,"Create"),u.forEach(Be),f.forEach(Be),this.h()},h(){je(r,"class","px-4 py-2 bg-perlwinkle rounded text-2xl shadow-bistre shadow-sm"),r.disabled=s=!t[1],je(e,"class","text-center")},m(l,f){Et(l,e,f),Te(e,r),Te(r,i),o||(n=pn(r,"click",t[2]),o=!0)},p(l,f){f&2&&s!==(s=!l[1])&&(r.disabled=s)},d(l){l&&Be(e),o=!1,n()}}}function va(t){let e,r,i,s,o,n,l,f,u,S,_,m,v,B,O,w;function J(g,U){return g[1]===void 0?ya:ba}let H=J(t),V=H(t),h=t[1]!==void 0&&dn(t);return{c(){e=Tt(),r=Ge("div"),i=Ge("div"),s=Ge("h1"),o=pr("Create Schematic File"),n=Tt(),l=Ge("br"),f=Tt(),u=Ge("div"),S=Ge("label"),_=Ge("div"),V.c(),m=Tt(),v=Ge("input"),B=Tt(),h&&h.c(),this.h()},l(g){Kn("svelte-ylt5v9",hn.head).forEach(Be),e=St(g),r=We(g,"DIV",{class:!0});var q=nt(r);i=We(q,"DIV",{class:!0});var W=nt(i);s=We(W,"H1",{class:!0});var oe=nt(s);o=mr(oe,"Create Schematic File"),oe.forEach(Be),n=St(W),l=We(W,"BR",{}),f=St(W),u=We(W,"DIV",{class:!0});var he=nt(u);S=We(he,"LABEL",{for:!0,class:!0});var _e=nt(S);_=We(_e,"DIV",{class:!0});var we=nt(_);V.l(we),we.forEach(Be),m=St(_e),v=We(_e,"INPUT",{id:!0,type:!0,accept:!0}),_e.forEach(Be),B=St(he),h&&h.l(he),he.forEach(Be),W.forEach(Be),q.forEach(Be),this.h()},h(){hn.title="MidiMC | Create",je(s,"class","text-4xl"),je(_,"class","text-4xl"),je(v,"id","file"),je(v,"type","file"),je(v,"accept",".mid,.midi"),v.hidden=!0,je(S,"for","file"),je(S,"class","inline-block border-dashed border-2 border-bistre cursor-pointer p-2 text-center bg-tea"),je(u,"class","grid content-center space-y-8"),je(i,"class","my-8"),je(r,"class","mx-auto container")},m(g,U){Et(g,e,U),Et(g,r,U),Te(r,i),Te(i,s),Te(s,o),Te(i,n),Te(i,l),Te(i,f),Te(i,u),Te(u,S),Te(S,_),V.m(_,null),Te(S,m),Te(S,v),Te(u,B),h&&h.m(u,null),O||(w=pn(v,"change",t[3]),O=!0)},p(g,[U]){H===(H=J(g))&&V?V.p(g,U):(V.d(1),V=H(g),V&&(V.c(),V.m(_,null))),g[1]!==void 0?h?h.p(g,U):(h=dn(g),h.c(),h.m(u,null)):h&&(h.d(1),h=null)},i:Ar,o:Ar,d(g){g&&Be(e),g&&Be(r),V.d(),h&&h.d(),O=!1,w()}}}function ga(t,e,r){let i,s;const o=(f,u)=>{const S=new Blob([f]),_=document.createElement("a"),m=URL.createObjectURL(S);_.href=m,_.download=u,document.body.appendChild(_),_.click(),setTimeout(function(){document.body.removeChild(_),window.URL.revokeObjectURL(m)},0)},n=async()=>{if(!i){console.log("No file was selected");return}const f=i.name.split(".")[0],u=await i.arrayBuffer(),S=ua(new Ot.Midi(u)),_=fa(S),m=await qi(_);o(new Uint8Array(Vr.zip(m)),`${f}.schem`)};function l(){s=this.files,r(0,s)}return t.$$.update=()=>{t.$$.dirty&1&&r(1,i=s&&s[0])},[s,i,n,l]}class _a extends zn{constructor(e){super(),Yn(this,e,ga,va,Xn,{})}}export{_a as default};
